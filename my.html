<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>è¶…å®‡å®™æ–‡æ˜ Â· æˆ‘çš„</title>
<style>
:root{--palace-red:#b71c1c;--palace-gold:#d4af37;--paper:#fdfaf6;--ink:#2c2c2c;--gap:20px;}
body{margin:0;font-family:Microsoft YaHei,serif;background:var(--paper);color:var(--ink);}
a{color:var(--palace-red);text-decoration:none;}
header{position:sticky;top:0;z-index:10;background:var(--palace-red);display:flex;justify-content:space-between;align-items:center;padding:10px 20px;box-shadow:0 2px 8px rgba(0,0,0,.1);}
header .logo{color:#fff;font-size:18px;font-weight:bold;}
header .user-bar{display:flex;align-items:center;gap:15px;color:#fff;font-size:14px;}
header button{padding:6px 12px;border:none;border-radius:4px;cursor:pointer;}
header .home-btn{background:#e8f3ff;color:#165dff;}
header .logout-btn{background:#f53f3f;color:#fff;}
.wrap{display:flex;max-width:1200px;margin:auto;padding:var(--gap);}
aside{width:320px;background:#fff;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,.05);padding:25px;}
main{flex:1;margin-left:var(--gap);display:flex;flex-direction:column;gap:var(--gap);}
.avatar-box{text-align:center;margin-bottom:25px;}
.avatar{width:100px;height:100px;border-radius:50%;background:#e8f3ff;display:flex;align-items:center;justify-content:center;font-size:40px;color:#165dff;margin:0 auto;position:relative;cursor:pointer;}
.avatar input{position:absolute;width:100%;height:100%;opacity:0;cursor:pointer;}
.info-item{margin-bottom:18px;font-size:14px;}
.info-item .label{color:#86909c;display:inline-block;width:80px;}
.edit-btn{width:100%;padding:10px;background:#f5f7fa;border:1px solid #e5e6eb;border-radius:4px;cursor:pointer;margin-top:10px;}
.section{display:none;background:#fff;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,.05);padding:25px;}
.section.active{display:block;}
.section h2{margin:0 0 20px;color:var(--palace-red);}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;}
.form-grid .full{grid-column:1/3;}
.form-grid label{display:block;font-size:14px;margin-bottom:6px;}
.form-grid input,.form-grid select,.form-grid textarea{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;}
button.submit{padding:8px 20px;background:var(--palace-red);color:#fff;border:none;border-radius:30px;cursor:pointer;}
.record-list{margin-top:15px;font-size:14px;}
.record-item{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px dashed #f2f3f5;}
#check-in{max-width:400px;margin:30px auto;padding:20px;border:2px solid var(--palace-gold);border-radius:8px;text-align:center;background:#fff;}
#check-in h3{margin:0 0 10px;color:var(--palace-red);}
#check-status{font-size:14px;color:#666;margin-bottom:15px;}
#btn-check{padding:10px 30px;font-size:16px;background:var(--palace-red);color:#fff;border:none;border-radius:30px;cursor:pointer;}
#btn-check:disabled{background:#999;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:100;}
.modal.show{display:flex;}
.modal-content{background:#fff;width:90%;max-width:600px;border-radius:8px;padding:25px;max-height:80vh;overflow-y:auto;}
.modal-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;}
.close-btn{font-size:24px;cursor:pointer;color:#999;}
.en{display:none;}
</style>
</head>
<body>

<header>
    <div class="logo">è¶…å®‡å®™æ–‡æ˜ Â· æˆ‘çš„</div>
    <div class="user-bar">
        <span id="currentUser">åŠ è½½ä¸­â€¦</span>
        <button class="home-btn" onclick="location.href='index.html'">è¿”å›é¦–é¡µ</button>
        <button class="logout-btn" onclick="location.href='login.html'">é€€å‡ºç™»å½•</button>
        <button onclick="toggleLang()">ä¸­/EN</button>
    </div>
</header>

<div class="wrap">
<aside>
    <div class="avatar-box">
        <div class="avatar">
    <img id="avatarImg" src="" 
         style="width:100%;height:100%;object-fit:cover;border-radius:50%;">
    <input type="file" accept="image/*" id="avatarUpload">
</div>
        <p style="font-size:13px;color:#86909c;">ç‚¹å‡»æ›´æ¢å¤´åƒ</p>
    </div>
    <div class="info-item"><span class="label">ç”¨æˆ·åï¼š</span><span id="userName">--</span></div>
    <div class="info-item"><span class="label">é€šè¯ï¼š</span><span id="userToken">--</span></div>
    <div class="info-item"><span class="label">æ–‡æ˜ç­‰çº§ï¼š</span><span id="userLevel">åˆå§‹æ¢ç´¢è€…</span></div>
    <div class="info-item"><span class="label">åŠ å…¥æ—¶é—´ï¼š</span><span>2024-01-01</span></div>
    <button class="edit-btn" onclick="editUserName()">ç¼–è¾‘ä¸ªäººä¿¡æ¯</button>

    <section id="check-in">
        <h3 class="zh">æ¯æ—¥ç­¾åˆ°</h3><h3 class="en">Daily Check-in</h3>
        <p id="check-status" class="zh">ä»Šæ—¥å°šæœªç­¾åˆ°</p><p id="check-status" class="en">Not checked in today</p>
        <button id="btn-check" onclick="doCheckIn()">ä¸€é”®ç­¾åˆ° / Check-in</button>
        <p class="zh" style="margin-top:10px;font-size:13px;color:#666;">è¿ç»­ç­¾åˆ°ï¼š<span id="streak">0</span> å¤©</p>
        <p class="en" style="margin-top:10px;font-size:13px;color:#666;">Streakï¼š<span id="streak">0</span> days</p>
    </section>
</aside>

<main>
    <nav style="display:flex;gap:15px;margin-bottom:var(--gap);">
        <button class="submit" onclick="showSec('account')">è´¦å·ç®¡ç†</button>
        <button class="submit" onclick="showSec('general')">é€šç”¨</button>
        <button class="submit" onclick="showSec('privacy')">éšç§</button>
        <button class="submit" onclick="showSec('gov')">æ”¿åŠ¡ä¿¡æ¯</button>
        <button class="submit" onclick="showSec('parliament')">è®®æ¡ˆæŠ•ç¥¨</button>
        <button class="submit" onclick="showSec('other')">å…¶ä»–</button>
        <button class="submit" onclick="showSec('citizen')">å…¬æ°‘äº’åŠ¨</button>
        <button class="submit" onclick="location.href='gen.html'">ç”µå·ç”Ÿæˆ</button>
        <button class="submit" onclick="showSec('transport')">äº¤é€šè®¢ç¥¨</button>
    </nav>

<script>
// å¤´åƒåŠŸèƒ½ JS
document.addEventListener("DOMContentLoaded", function () {
    const avatarImg = document.getElementById("avatarImg");
    const savedAvatar = localStorage.getItem("userAvatar");
    if (savedAvatar) {
        avatarImg.src = savedAvatar;
    } else {
        avatarImg.src = "data:image/svg+xml,\
<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100'>\
<rect width='100%' height='100%' fill='%23e8f3ff'/>\
<text x='50%' y='55%' font-size='45' text-anchor='middle' fill='%23165dff'>ğŸŒŒ</text>\
</svg>";
    }
});

document.getElementById("avatarUpload").addEventListener("change", function () {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
        const imgSrc = e.target.result;
        document.getElementById("avatarImg").src = imgSrc;
        localStorage.setItem("userAvatar", imgSrc);
    };
    reader.readAsDataURL(file);
});
</script>

    <!-- è´¦å·ç®¡ç† -->
    <section id="account" class="section active">
        <h2>è´¦å·ç®¡ç†</h2>
        <label>æ˜µç§°</label><input id="nickname" placeholder="æ˜µç§°">
        <label>å‡ºç”Ÿæ—¥æœŸ</label><input type="date" id="birthday">
        <label>ä¸ªäººç®€ä»‹</label><textarea id="bio" rows="3"></textarea>
        <button class="submit" onclick="saveAccount()">ä¿å­˜èµ„æ–™</button>
    </section>

    <!-- é€šç”¨ -->
    <section id="general" class="section">
        <h2>é€šç”¨è®¾ç½®</h2>
        <label>è¯­è¨€</label>
        <select id="lang"><option value="zh">ä¸­æ–‡</option><option value="en">English</option></select>
        <label>ä¸»é¢˜</label>
        <select id="theme"><option value="light">æµ…è‰²</option><option value="dark">æ·±è‰²</option></select>
        <label><input type="checkbox" id="notify"> å¯ç”¨ç³»ç»Ÿé€šçŸ¥</label>
        <button class="submit" onclick="saveGeneral()">ä¿å­˜è®¾ç½®</button>
    </section>

    <!-- éšç§ -->
    <section id="privacy" class="section">
        <h2>éšç§è®¾ç½®</h2>
        <label><input type="checkbox" id="public"> å…è®¸å…¶ä»–ç”¨æˆ·æŸ¥çœ‹æˆ‘çš„èµ„æ–™</label>
        <label><input type="checkbox" id="online"> æ˜¾ç¤ºåœ¨çº¿çŠ¶æ€</label>
        <div style="margin-top:15px;">
            <button class="submit" onclick="exportData()">å¯¼å‡ºæˆ‘çš„æ•°æ®</button>
            <button class="submit" onclick="if(confirm('ç¡®å®šæ°¸ä¹…æ³¨é”€ï¼Ÿ')){localStorage.clear();location.reload()}">æ°¸ä¹…æ³¨é”€</button>
        </div>
    </section>

    <!-- æ”¿åŠ¡ä¿¡æ¯ -->
    <section id="gov" class="section">
        <h2>æ”¿åŠ¡ä¿¡æ¯</h2>
        <div class="form-grid">
            <div><label>é€šè¯ç¼–å·</label><input id="tokenId" readonly></div>
            <div><label>ç­¾å‘æœºå…³</label><input id="issuer" readonly></div>
            <div><label>ç­¾å‘æ—¥æœŸ</label><input type="date" id="issueDate" readonly></div>
            <div><label>æœ‰æ•ˆæœŸè‡³</label><input type="date" id="expiryDate" readonly></div>
            <div class="full"><label>æ˜Ÿé™…é€šè¡Œæƒé™</label><textarea id="permissions" readonly></textarea></div>
        </div>
        <button class="submit" onclick="downloadCertificate()">ä¸‹è½½è¯ä»¶PDF</button>
    </section>
    
    <section id="parliament" class="section">
    <h2>è®®æ¡ˆæŠ•ç¥¨</h2>
    <div id="proposal-list">
        <!-- åŠ¨æ€ç”Ÿæˆçš„è®®æ¡ˆä¼šæ’å…¥è¿™é‡Œ -->
    </div>
</section>

    <!-- å…¶ä»– -->
    <section id="other" class="section">
        <h2>å…¶ä»–</h2>
        <label>æ”¶è—å¤¹</label><textarea id="favorites" rows="4" placeholder="ç²˜è´´æ”¶è—é“¾æ¥æˆ–æ–‡å­—"></textarea>
        <label>ç¬”è®°</label><textarea id="notes" rows="6" placeholder="ä¸ªäººç¬”è®°"></textarea>
        <label>å¿«æ·çŸ­è¯­</label><input id="quickPhrase" placeholder="ä¸€é”®å‘é€çš„çŸ­è¯­">
        <button class="submit" onclick="saveOther()">ä¿å­˜å…¶ä»–</button>
    </section>

    <!-- å…¬æ°‘äº’åŠ¨ -->
    <section id="citizen" class="section">
        <h2>å…¬æ°‘äº’åŠ¨åŠŸèƒ½</h2>
        <button class="submit" onclick="openModal('modal-apply')">é€šè¯ç”³é¢†æ¨¡æ‹Ÿ</button>
        <button class="submit" onclick="openModal('modal-calc')">åŸŸå¤–å…‘æ¢è®¡ç®—å™¨</button>
        <button class="submit" onclick="openModal('modal-query')">æ˜Ÿé™…å¤‡æ¡ˆæŸ¥è¯¢</button>
        <button class="submit" onclick="openModal('modal-feedback')">æ„è§åé¦ˆ</button>
        <button class="submit" onclick="openModal('modal-law')">æ³•å¾‹æ–‡ä»¶å¯¼èˆª</button>
    </section>

    <!-- æ¢ç´¢è®°å½• -->
    <section class="section active">
        <h2>è¶…å®‡å®™æ¢ç´¢è®°å½•</h2>
        <div class="record-list">
            <div class="record-item"><span>æµè§ˆã€Œè¶…å®‡å®™èµ·æºã€æ ¸å¿ƒæ–‡æ¡£</span><span class="record-time">2024-05-10 14:23</span></div>
            <div class="record-item"><span>è§£é”ã€Œæ˜Ÿé™…ç–†åŸŸã€åŸºç¡€æ˜Ÿå›¾</span><span class="record-time">2024-05-08 09:45</span></div>
            <div class="record-item"><span>é¦–æ¬¡å®Œæˆèº«ä»½éªŒè¯ç™»å½•</span><span class="record-time">2024-05-01 16:10</span></div>
        </div>
    </section>
</main><!-- ===== æ¡Œé¢å¸¸é©»åŠŸèƒ½é›†åˆ ===== -->
<section class="section active" style="margin-top:var(--gap);">
    <h2>å¿«æ·åŠŸèƒ½åŒº</h2>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px;">
        <button class="submit" onclick="openModal('modal-register')">æ³¨å†Œ/ç»­æœŸé€šè¯</button>
        <button class="submit" onclick="openModal('modal-special')">ç”³è¯·è®¿é—®ç‰¹åŒº</button>
        <button class="submit" onclick="openModal('modal-history')">å†å²è®°å½•</button>
        <button class="submit" onclick="openModal('modal-support')">åœ¨çº¿å®¢æœ</button>
        <button class="submit" onclick="openModal('modal-changepwd')">ä¿®æ”¹å¯†ç </button>
        <button class="submit" onclick="openModal('modal-bind')">ç»‘å®šæ‰‹æœº/é‚®ç®±</button>
        <button class="submit" onclick="openModal('modal-loginhist')">ç™»å½•å†å²</button>
    </div>
</section>

</div>

<!-- ===== å¼¹å±‚é›†åˆ ===== -->
<div id="modal-apply" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">é€šè¯ç”³é¢†æ¨¡æ‹Ÿ</span><span class="en">Token Application</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('ç”³é¢†æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label class="zh">å§“å</label><input required><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-calc" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">åŸŸå¤–å…‘æ¢è®¡ç®—å™¨</span><span class="en">Exchange Calculator</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <label class="zh">è¾“å…¥çºªå¿µå¸æ•°é‡</label><input type="number" id="coin" placeholder="100"><button class="submit" onclick="alert('å¯å…‘æ¢ '+(document.getElementById('coin').value*1.2)+' å¤–å¸ï¼ˆæ¨¡æ‹Ÿï¼‰')">è®¡ç®—</button>
</div></div>

<div id="modal-query" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ˜Ÿé™…å¤‡æ¡ˆæŸ¥è¯¢</span><span class="en">Record Query</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <input placeholder="è¾“å…¥é€šè¯ç¼–å·"><button class="submit" onclick="alert('æŸ¥è¯¢ç»“æœï¼šæ— é™åˆ¶é€šè¡Œï¼ˆæ¨¡æ‹Ÿï¼‰')">æŸ¥è¯¢</button>
</div></div>

<div id="modal-feedback" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ„è§åé¦ˆ</span><span class="en">Feedback</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼');closeModal();return false;"><select required><option value="">é€‰æ‹©æœºæ„</option><option>è§‰æ€§ç›‘å¯Ÿé™¢</option><option>è¶…å®‡å®™æŠ€æœ¯é™¢</option><option>åœ£ä¸–ç ”ç©¶åšè§ˆé™¢</option></select><textarea rows="4" required placeholder="è¯·å¡«å†™æ„è§"></textarea><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-law" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ³•å¾‹æ–‡ä»¶å¯¼èˆª</span><span class="en">Law Navigation</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <ul><li><a href="#">ç¬¬ä¸€ç«  æ€»åˆ™</a></li><li><a href="#">ç¬¬äºŒç«  é«˜ç»´å…¬æ°‘æƒ</a></li><li><a href="#">ç¬¬ä¸‰ç«  æ˜Ÿé™…é€šè¡Œ</a></li></ul>
</div></div>

<div id="modal-register" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ³¨å†Œ/ç»­æœŸé€šè¯</span><span class="en">Register/Renew</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('æäº¤æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label class="zh">å§“å</label><input required><label class="zh">èº«ä»½è¯å·ç </label><input required><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-special" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ç”³è¯·è®¿é—®ç‰¹åŒº</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('ç”³è¯·å·²æäº¤ï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>ç›®çš„åœ°åŒº</label><select><option>ç€›å‡°ç‰¹åŒº</option><option>å®‡è”ç‰¹åŒº</option></select><label>ç”³è¯·ç†ç”±</label><textarea rows="4" required></textarea><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-history" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">å†å²è®°å½•</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <table width="100%"><tr><th>æ—¥æœŸ</th><th>æ“ä½œ</th></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆä¸€æ—¥</td><td>æ³¨å†Œé€šè¯</td></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆäº”æ—¥</td><td>ç”³è¯·è®¿é—®ç€›å‡°ç‰¹åŒº</td></tr></table>
</div></div>

<div id="modal-support" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">åœ¨çº¿å®¢æœ</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('é—®é¢˜å·²æäº¤ï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>é—®é¢˜æè¿°</label><textarea rows="4" required></textarea><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-changepwd" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ä¿®æ”¹å¯†ç </span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('å¯†ç ä¿®æ”¹æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>å½“å‰å¯†ç </label><input type="password" required><label>æ–°å¯†ç </label><input type="password" required><label>ç¡®è®¤æ–°å¯†ç </label><input type="password" required><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-bind" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ç»‘å®šæ‰‹æœº/é‚®ç®±</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('ç»‘å®šæˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>æ‰‹æœºå·</label><input required><label>é‚®ç®±</label><input type="email" required><button class="submit" type="submit">ç»‘å®š</button></form>
</div></div>

<div id="modal-loginhist" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ç™»å½•å†å²</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <table width="100%"><tr><th>æ—¥æœŸ</th><th>ç™»å½•åœ°ç‚¹</th></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆäºŒæ—¥</td><td>äº¬å¸ˆå‡¡å¤šä¸‡</td></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆå››æ—¥</td><td>ç€›å‡°ç‰¹åŒº</td></tr></table>
</div></div>

<script>
/* ===== å·¥å…· ===== */
const $=s=>document.querySelector(s);
function getParam(){
    const p={};
    location.search.slice(1).split('&').forEach(kv=>{
        const [k,v]=kv.split('=');
        p[k]=v?decodeURIComponent(v):'';
    });
    return p;
}
/* ===== å®ˆé—¨ + èµ‹å€¼ ===== */
const params=getParam();
if(!params.token||!params.name){alert('è¯·å…ˆç™»å½•');location.href='login.html';}
else{
    $('#currentUser').textContent=params.name;
    $('#userName').textContent=params.name;
    $('#userToken').textContent=params.token;
}
/* ===== åŒè¯­ ===== */
function toggleLang(){
    const isZh=$('html').lang!=='en';
    document.querySelectorAll('.zh').forEach(e=>e.style.display=isZh?'none':'block');
    document.querySelectorAll('.en').forEach(e=>e.style.display=isZh?'block':'none');
    $('html').lang=isZh?'en':'zh';
}
/* ===== æ¿å— ===== */
function showSec(id){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    $('#'+id).classList.add('active');
}
/* ===== ç­¾åˆ° ===== */
const todayKey='checkIn_'+new Date().toISOString().slice(0,10);
function initCheck(){
    const done=localStorage.getItem(todayKey);
    const streak=localStorage.getItem('streakTotal')||'0';
    $('#streak').textContent=streak;
    if(done){$('#btn-check').disabled=true;$('#btn-check').textContent='å·²ç­¾åˆ°';$('#check-status').textContent='ä»Šæ—¥å·²ç­¾åˆ°';}
}
function doCheckIn(){
    localStorage.setItem(todayKey,'1');
    let total=parseInt(localStorage.getItem('streakTotal')||'0');
    localStorage.setItem('streakTotal',total+1);
    $('#streak').textContent=total+1;
    $('#btn-check').disabled=true;$('#btn-check').textContent='å·²ç­¾åˆ°';
    $('#check-status').textContent='ç­¾åˆ°æˆåŠŸï¼æ„¿æ‚¨ä»Šæ—¥æä¹åœ†æ»¡ã€‚';
}
initCheck();
/* ===== å¤´åƒ ===== */
$('#avatarUpload').addEventListener('change',e=>{
    const file=e.target.files[0];if(!file)return;
    const reader=new FileReader();
    reader.onload=ev=>{$('.avatar').style.backgroundImage=`url(${ev.target.result})`;localStorage.setItem('avatar',ev.target.result);}
    reader.readAsDataURL(file);
});
/* ===== ç¼–è¾‘ç”¨æˆ·å ===== */
function editUserName(){
    const name=prompt('æ–°ç”¨æˆ·å',params.name);
    if(name&&name.trim()){$('#userName').textContent=name;$('#currentUser').textContent=name;}
}
/* ===== ä¿å­˜ ===== */
function saveAccount(){
    localStorage.setItem('nickname',$('#nickname').value);
    localStorage.setItem('birthday',$('#birthday').value);
    localStorage.setItem('bio',$('#bio').value);
    alert('å·²ä¿å­˜ï¼ˆæœ¬åœ°ï¼‰');
}
function saveGeneral(){
    localStorage.setItem('lang',$('#lang').value);
    localStorage.setItem('theme',$('#theme').value);
    localStorage.setItem('notify',$('#notify').checked);
    alert('å·²ä¿å­˜ï¼ˆæœ¬åœ°ï¼‰');
}
function saveOther(){
    localStorage.setItem('favorites',$('#favorites').value);
    localStorage.setItem('notes',$('#notes').value);
    localStorage.setItem('quickPhrase',$('#quickPhrase').value);
    alert('å·²ä¿å­˜ï¼ˆæœ¬åœ°ï¼‰');
}
function exportData(){
    const data={
        account:{nickname:localStorage.getItem('nickname'),birthday:localStorage.getItem('birthday'),bio:localStorage.getItem('bio')},
        general:{lang:localStorage.getItem('lang'),theme:localStorage.getItem('theme'),notify:localStorage.getItem('notify')},
        other:{favorites:localStorage.getItem('favorites'),notes:localStorage.getItem('notes'),quickPhrase:localStorage.getItem('quickPhrase')}
    };
    const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');a.href=url;a.download='myData.json';a.click();URL.revokeObjectURL(url);
}
function downloadCertificate(){
    const cert={name:localStorage.getItem('nickname')||'ç”¨æˆ·',tokenId:'DLR-2025-0001',issuer:'ä¸­å¤®åˆ¶è¯å‘è¯æ€»ç½²',issueDate:'2025-01-01',expiryDate:'2034-01-01',permissions:'å‡¡å¤šã€ç€›å‡°ã€å—æè¾¹åŒºéƒ½æŠ¤ã€å¦‚æ„è·¯å…¨åŸŸé€šè¡Œ'};
    const blob=new Blob([JSON.stringify(cert,null,2)],{type:'application/pdf'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');a.href=url;a.download='certificate.json';a.click();URL.revokeObjectURL(url);
}
/* ===== å¼¹å±‚ ===== */
function openModal(id){$('#'+id).classList.add('show');}
function closeModal(){document.querySelectorAll('.modal').forEach(m=>m.classList.remove('show'));}
/* ===== æœåŠ¡å…¥å£ ===== */
function registerRenew(){openModal('modal-register');}
function applySpecialAccess(){openModal('modal-special');}
function viewHistory(){openModal('modal-history');}
function onlineSupport(){openModal('modal-support');}
function changePassword(){openModal('modal-changepwd');}
function bindPhoneEmail(){openModal('modal-bind');}
function viewLoginHistory(){openModal('modal-loginhist');}
</script>
<script>
function generateProposal(id) {
    const titles = [
        "å¤§å‡‰å›½åŸºç¡€è®¾æ–½å»ºè®¾",
        "è¶…å®‡å®™æ–‡æ˜ç§‘ç ”è®¡åˆ’",
        "å…¨æ°‘æ–‡åŒ–æ•™è‚²æå‡",
        "ç”Ÿæ€ä¿æŠ¤ä¸è‡ªç„¶æ³•ç»´æŠ¤",
        "å›½æ°‘å¹¸ç¦æŒ‡æ•°æå‡é¡¹ç›®",
        "å…¬å…±å®‰å…¨ä¸é˜²æŠ¤ç³»ç»Ÿä¼˜åŒ–"
    ];
    const descs = [
        "æå‡å…¨å›½å„åœ°åŸºç¡€è®¾æ–½å»ºè®¾æ°´å¹³",
        "èµ„åŠ©è¶…å®‡å®™æ–‡æ˜ç§‘ç ”é¡¹ç›®",
        "æ™®åŠæ–‡åŒ–æ•™è‚²ï¼Œæå‡æ–‡æ˜ç´ å…»",
        "åŠ å¼ºç”Ÿæ€ä¿æŠ¤ä¸è‡ªç„¶æ³•æ‰§è¡Œ",
        "æ”¹å–„æ°‘ç”Ÿï¼Œæé«˜å…¬æ°‘å¹¸ç¦æ„Ÿ",
        "å®Œå–„å…¬å…±å®‰å…¨ä¸é˜²æŠ¤ä½“ç³»"
    ];
    const t = titles[Math.floor(Math.random() * titles.length)];
    const d = descs[Math.floor(Math.random() * descs.length)];
    
    return { id, title: t, desc: d };
}

function renderProposals(count = 5) {
    const container = document.getElementById("proposal-list");
    container.innerHTML = "";
    for (let i = 1; i <= count; i++) {
        const p = generateProposal(i);
        const div = document.createElement("div");
        div.className = "proposal-item";
        div.style.borderBottom = "1px dashed #f2f3f5";
        div.style.padding = "10px 0";
        div.innerHTML = `
            <p><strong>è®®æ¡ˆæ ‡é¢˜ï¼š</strong>${p.title}</p>
            <p><strong>ç®€ä»‹ï¼š</strong>${p.desc}</p>
            <button onclick="voteProposal(${p.id}, 'yes')">æ”¯æŒ âœ…</button>
            <button onclick="voteProposal(${p.id}, 'no')">åå¯¹ âŒ</button>
        `;
        container.appendChild(div);
    }
}

function voteProposal(id, choice) {
    alert(`ä½ å¯¹è®®æ¡ˆ ${id} çš„æŠ•ç¥¨ï¼š${choice}`);
}

// é¡µé¢åŠ è½½æ—¶ç”Ÿæˆè®®æ¡ˆ
document.addEventListener("DOMContentLoaded", function () {
    renderProposals(5);
});
</script>
<!-- ========== äº¤é€šè®¢ç¥¨ start ========== -->
<section id="transport" class="section" style="display:none;padding:20px;background:#fff;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,.04);">
  <h2 style="color:#004d99;margin-top:0;">äº¤é€šè®¢ç¥¨</h2>

  <div style="display:flex;gap:16px;flex-wrap:wrap;align-items:center;margin-bottom:12px;">
    <label>å‡ºå‘åœ°ï¼š
      <select id="sel-province-from"></select>
    </label>

    <label>å‡ºå‘ - åºœï¼š
      <select id="sel-pref-from"></select>
    </label>

    <label>å‡ºå‘ - å¿/åŒºï¼š
      <select id="sel-county-from"></select>
    </label>

    <label>ç›®çš„åœ°ï¼š
      <select id="sel-province-to"></select>
    </label>

    <label>ç›®çš„ - åºœï¼š
      <select id="sel-pref-to"></select>
    </label>

    <label>ç›®çš„ - å¿/åŒºï¼š
      <select id="sel-county-to"></select>
    </label>
  </div>

  <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-bottom:12px;">
    <label>å‡ºè¡Œæ–¹å¼ï¼š
      <select id="sel-mode">
        <option value="train">ç«è½¦</option>
        <option value="highspeed">é«˜é“</option>
        <option value="plane">é£æœº</option>
        <option value="ship">è½®èˆ¹</option>
      </select>
    </label>

    <label>å‡ºå‘æ—¥æœŸï¼š
      <input type="date" id="dep-date">
    </label>

    <label>å‡ºå‘æ—¶é—´ï¼ˆåå¥½ï¼‰ï¼š
      <input type="time" id="dep-time">
    </label>

    <label>èˆ±ä½/åº§ä½ç±»å‹ï¼š
      <select id="sel-class">
        <option value="standard">æ™®é€š</option>
        <option value="comfort">èˆ’é€‚</option>
        <option value="first">å¤´ç­‰/å•†åŠ¡</option>
      </select>
    </label>

    <label>ä¹˜å®¢å§“åï¼š
      <input type="text" id="passenger-name" placeholder="å¡«å†™çœŸå®å§“å">
    </label>

    <label>ä¹˜å®¢æ•°ï¼š
      <input type="number" id="passenger-count" value="1" min="1" style="width:80px;">
    </label>
  </div>

  <div style="margin-bottom:12px;">
    <button id="btn-search" class="submit" style="padding:8px 16px;">æŸ¥è¯¢å¯è®¢è½¦æ¬¡/èˆªç­</button>
    <button id="btn-clear" style="padding:8px 16px;margin-left:8px;">é‡ç½®</button>
  </div>

  <!-- æœç´¢åˆ°çš„è½¦æ¬¡/èˆªç­åˆ—è¡¨ -->
  <div id="results" style="margin-top:16px;"></div>

  <!-- å·²é¢„è®¢è®¢å• -->
  <div id="my-orders" style="margin-top:22px;">
    <h3 style="margin:8px 0 6px;color:#333;">æˆ‘çš„è®¢å•</h3>
    <div id="orders-list"></div>
  </div>
</section>
<!-- ========== äº¤é€šè®¢ç¥¨ end ========== -->
<script id="region-data">
// ==== å¤§å‡‰å›½çœ-åºœ-å¿ ä¸‰çº§æ•°æ®ï¼ˆå·²æ‹†å‡ºï¼Œç›´æ¥æ”¾è¿™é‡Œå³å¯ï¼‰ ====
const regions = {
  "æ±Ÿä¸­é“": {
    "å¿ å·åºœ": ["å—åŸå¿","åŒ—åŸå¿"],
    "è¾¹åŸåºœ": ["è¾¹å—å¿","è¾¹åŒ—å¿"],
    "å››éƒ¨åºœ": ["å››ä¸€éƒ¨","å››äºŒéƒ¨"],
    "ä¸­é˜´åºœ": ["ä¸­é˜´èšè½"]
  },
  "å·é˜³é“": {
    "ä¸­é˜³åºœ": ["é«˜é™µå¿"],
    "å‘¨åº·åºœ": ["é‡‡é‚‘å…¬ç¤¾"],
    "ç¿Šå·åºœ": ["ç¿Šå·èšè½"]
  },
  "å®šå·é“": {
    "é¡ºåº†åºœ": ["é¡ºåº†å¿"],
    "å†å·åºœ": ["å¿˜å¿§åŒº"],
    "å®ååºœ": ["å®åå¿"],
    "æ³½å·åºœ": ["æ³½å·å¿"],
    "å°é™µåºœ": ["å¤©é‡‡å…¬ç¤¾"]
  },
  "äº¬ç•¿é“": {
    "ä¼šå·åºœ": ["å—ä¼šå¿","é˜³å…³å¿"],
    "ä¸œååºœ": ["ä¸œåå¿"],
    "ä¸œç‰åºœ": ["ä¸œç‰ç’ƒå±±è„‰è‡ªç„¶ç”Ÿæ€ä¿æŠ¤åŒº"],
    "åœ£å¤©å…ƒå ¡": ["åœ£å¤©å ¡èšè½"],
    "åœ£é¢œå®‡ç¿”å ¡": ["æ–‡æ–¼å…¬ç¤¾"]
  },
  "è¥¿ç‰é“": {
    "å±±å—åºœ": ["å‘èµ§åŒº"],
    "ç®•å°¾åºœ": ["åŸå—å¿"],
    "å·å—æ—åŒº": ["çµå±±å¿"]
  },
  "å˜‰æ­é“": {
    "ä½™å·åºœ": ["é”¦ä¸Šå…¬ç¤¾"],
    "æ±Ÿå—åºœ": ["æ²æ±Ÿå…¬ç¤¾","æ±Ÿå³å…¬ç¤¾"]
  },
  "å®ªå®½é“": {
    "é¡ºéƒ½åºœ": ["ä¸­éƒ½å…¬ç¤¾","å¤©ä¸­å¿","æ±Ÿä¸œå¿"],
    "ç¥ä¸­åºœ": ["ç¥ä¸­å¿"],
    "æ˜å®‰åºœ": ["æ˜å®‰å¿"]
  },
  "å¹³åŸé“": {
    "æˆé‚‘åºœ": ["åœ£éƒ½å…¬ç¤¾"],
    "å‡½å·åºœ": ["å‡½å·å¿"],
    "ä¸­æ—¸åºœ": ["ä¸­æ—¸å¿"]
  },
  "åºç˜é“": {
    "åˆæ±Ÿåºœ": ["å¹³è‡³å¿"],
    "æ·é˜´åºœ": ["æ·é˜´å¿"],
    "é›åº†åºœ": ["é›åº†å¿"]
  },
  "æœ”å£é“": {
    "ä¸­æŠ¤åºœ": ["å…³å—å¿"],
    "è¥¿å’Œåºœ": ["å±±æˆŠå¿"]
  },
  "å¹¿åŒ—é“": {
    "å¹¿å®åºœ": ["å¹¿å®å¿"],
    "ä¹Ÿå·åºœ": ["ä¹Ÿå·å¿"],
    "å…‰ååºœ": ["å…‰åå¿"],
    "ä¸‡æ± åºœ": ["å³¡é—´å¿","è¥¿åœ°å¿","å—æ± å¿","ä¸œæ¶Ÿå¿"],
    "é‚‘å·åºœ": ["å²­å—å¿"],
    "æœ›å·åºœ": ["æŸ“é™‚å¿"],
    "æ´²è§’åºœ": ["ä¸´æ²™å¿"]
  },
  "ä¸Šå†é»é“": {
    "å£è¾¹åºœ": ["å£è¾¹å¿"],
    "åº†å»åºœ": ["åº†å»å¿"],
    "æµ·é˜²æ¸¯åºœ": ["æµ·é˜²èšè½"],
    "è¥¿å·åºœ": ["è¥¿å·å¿"],
    "å¾åº†å…ƒåºœ": []
  },
  "çœŸå’Œé“": {
    "æµ·å—åºœ": ["æµ·å—å¿"]
  },
  "ç¦¹è¿œé“": {
    "ä¸œå®åºœ": ["ä¸œå®å¿"],
    "å¹¿å¹³åºœ": ["å¹¿å¹³å¿"],
    "æ–‡æ­£åºœ": ["æ–‡æ­£å¿"],
    "ç¦¹æ’åºœ": ["ç¦¹æ’å¿"],
    "æ™¨å·åºœ": ["æ™¨å·å¿"],
    "æ¸…è¿œåºœ": ["æ¸…è¿œå¿"],
    "ä¸´å°‘åºœ": ["è‰¾æ’å…¬ç¤¾"],
    "å¤¹å·åºœ": ["å¤¹å·å¿"]
  },
  "æ™¯é˜³é“": {
    "å®«é˜³åºœ": ["èŠ±æ¶¯åŒº","æ±Ÿé™µåŒº"],
    "æ˜ååºœ": ["æ˜åå¿"],
    "æ™–è‰¯åºœ": ["æ™–è‰¯å¿"]
  },
  "ä¹å‡‰é“": {
    "é«˜å‡‰åºœ": ["é«˜å‡‰å¿"],
    "å¹³é¢–åºœ": ["å¹³é¢–å¿"],
    "æ°‘æ²»åºœ": ["æ°‘å’Œå¿","é½æ²»å¿"],
    "ä¸­ååºœ": [],
    "ä¸‹å‡‰åºœ": [],
    "å±±å·åºœ": []
  },
  "å®‰è¯¸çœ": {
    "å‹å¼€åºœ": ["é’¦å­œå¿","ä¼—å®‰åŒº"],
    "è¶Šéƒ½åºœ": ["ä¸Šå®‰å¿"],
    "æ­£å¤ªåºœ": ["æ­£å¤ªå¿"],
    "é‚‘å·åºœ": ["å°šç«¹åŒº"]
  },
  "å¾·æ„å¿—ç½—æ›¼çœ": {
    "åœ£æŸæ—éƒ¡": ["å…‹æ‹‰ç»´äºšå¿"],
    "å„æ–¯æ›¼å¤§åŒº": ["å„æ–¯æ›¼èšè½"],
    "å“ˆå¾—é‡Œå¥¥å¤§åŒº": ["å“ˆå¾—é‡Œå¥¥èšè½"]
  },
  "å·´è¨å…‹çœ": {
    "å“ˆæ‹‰è‹å–‡åºœ": ["å“ˆæ‹‰è‹å–‡å¿"],
    "å“ˆå‰Œæ—ç‰¹åºœ": ["å“ˆå‰Œæ—ç‰¹å¿"],
    "è’™è½¦åˆ©": ["è’™è½¦åˆ©èšè½"],
    "å—é¢æœµå„¿æˆˆå£": ["æˆˆå£èšè½"],
    "å·´è¨èµ›æ‰˜": ["é‚£åŠ å…‹åˆ—äºšéƒ¡"],
    "ä¹Œå¡ææ–¯": ["åˆ—å°”é‚£éƒ¡"],
    "åæ¢…æ‹‰": ["ä¹ŒåŠ å°”éƒ¡"],
    "æ—è¾¹": ["æ—è¾¹èšè½"],
    "æ•–å ‚": ["æ•–å ‚èšè½"],
    "å‘¼å°”æ—é‚£ç›Ÿ": ["å–€æ‹‰å°”æ——"],
    "ç‘Ÿæ—¥ä¸¹": ["ç‘Ÿæ—¥é‚£èšè½"],
    "çªå¥åˆ©äºšæ–¯å…‹": [],
    "ä¹Œå¯Ÿç±³å°”å°ç§‘åˆ—äºšå¸ƒå¡æ‹‰ç»´æ–¯å…‹": [],
    "è¿¦ä¼ç½—": []
  },
  "å—æè¾¹åŒºéƒ½æŠ¤": {
    "ä»™éšéƒ½åºœ": [],
    "çœŸåŒ–éƒ¨": [],
    "å¾·åŒ–éƒ¨": [],
    "å¦™ä¸Šé½é“éƒ¨": [],
    "æ¸…ä¸€éƒ¨": [],
    "è‰²åˆ—é‚£éƒ¨": [],
    "å…‰ä¸Šéƒ¨": [],
    "éœå°”æµ©æ—éƒ¨": []
  },
  "å¦‚æ„è·¯": {
    "å¦‚æ„åŸ": [],
    "å®è‡ªåœ¨": [],
    "é‡Šé‚£è¿¦èˆ": [],
    "æä¹åŸ": [],
    "å¦‚æ„å®ç‹": [],
    "æ¯—ç‰ç’ƒæ³¢ç½—å¥ˆ": [],
    "æ‘©è¯ƒè‹ç½—æè¯ƒ": [],
    "æ³¢æƒ¹é‚£èˆé‚£æ": [],
    "ç¦åŸ": [],
    "å‡€å": [],
    "æ™´å‡‰": [],
    "äº‘ç›¸": [],
    "æ‘©å°¼": [],
    "å‰åº†": [],
    "å…‰åŒ–": [],
    "æ—ƒæª€æµ·": [],
    "åœ†è§‰": [],
    "æ¸…æ³°": [],
    "ç©ºç›¸": []
  },
  "ç¢§è‰²æ¬¢å–œè·¯": { "æœªåˆ—å…·ä½“åºœ": [] },
  "äº¤æ¸¯åºœ": { "æ»Ÿé˜³å¿": [], "ä¸´æ¸šå¿": [], "æ²™æ¹¾å˜´åŒº": [], "é¥å®‰å…¬ç¤¾": [] },
  "çƒ­ä¹…åºœ": { "ä¼Šå¥ˆå¿": [] },
  "è¥„å·åºœ": { "åŸŸå—å¿": [] },
  "å‡¡å¤šåºœ": {
    "åœ£äº¬å…¬ç¤¾": ["é”¦å…‰è¡—é“"],
    "å¤§éƒ½å…¬ç¤¾": ["ä¸­äº¤è¡—é“"],
    "éº¦å’Œç»æµå¼€å‘åŒº": [],
    "çµæ³½å¿": ["ç™½æ˜­ä¹¡"],
    "æ™¯æ°‘å¿": [],
    "å±‹æ¡“å¿": ["å—æ¡“ä¹¡"],
    "è¥¿éƒŠæ–°åŒº": [],
    "èƒœå®‰æ–°åŒº": ["è§‚ä¸ŠåŒº"]
  },
  "ä¾åˆ©ä¼äº¦çœ": { "å¸ƒå“ˆæ‹‰éƒ¡": ["å¸ƒå“ˆæ‹‰èšè½"], "å„é‡Œäºšé‚£": ["å„é‡Œäºšé‚£èšè½"], "é˜¿æ‰ä¼Šå°”æ²™æ¼ åŒº": [] },
  "é˜¿åˆ—å¤«æ³°å·": {
    "é˜¿åˆ—å¤«æ³°éƒ¡": ["é˜¿åˆ—å¤«æ³°èšè½"],
    "ä¸æ—¥é‚£æ¯”å°”å¤§åŒº": ["ä¸æ—¥é‚£æ¯”å°”èšè½"],
    "å¥‘è«è¯ƒè€¶å¤«å¤§åŒº": ["å¥‘è«è¯ƒè€¶å¤«èšè½"],
    "å¡é›…æ ¼ç³å ¡å¤§åŒº": ["å¡é›…æ ¼ç³å ¡èšè½"]
  },
  "å‹è°Šé“": {
    "æ³•å…°ç‘": ["æ³•å…°ç‘èšè½"],
    "åº·ç‘": ["åº·ç‘èšè½"],
    "äº‘å®é»›ç»´è¯—": ["äº‘å®é»›ç»´è¯—èšè½"],
    "æ³¢å…‹å¸ƒæ´›å…‹": ["æ³¢å…‹å¸ƒæ´›å…‹èšè½"],
    "å¤šæƒ¹åŸƒè’™": []
  },
  "é˜¿åº•èˆåˆ©é“": {
    "æ—¥åº“å‰æ¶…é’¦": ["æ—¥åº“å‰æ¶…é’¦èšè½"],
    "ä¸Šåº·": ["ä¸Šåº·èšè½"],
    "è¥„å˜‰æªç‹": ["è¥„å˜‰æªç‹èšè½"],
    "ä¹Œå°”é‚£": ["ä¹Œå°”é‚£èšè½"],
    "æ‘©è¯ƒæ…•ææ–¯": ["æ‘©è¯ƒæ…•ææ–¯èšè½"]
  },
  "æ™®æ‹‰ç‰¹å°”åé‚¦": { "é˜¿ç“¦çº³åŸº": [], "å¡å…‹æ–¯æäºšé›¨æ—åŒº": [] },
  "ç›æè«å°”åœ°åŒº": { "ä¹Œé‡Œè€¶å…¹": [], "ä¹Œå¯Ÿä¸æ–¯": [], "ä¹Œå¯Ÿèµ›å¸ƒæ–¯â€¢æ¯”è€¶è¾“è¿¦é‚£": [], "æ‘©è¯ƒè¨æ—é‚£": [], "å¸ƒæ´›å…‹": [] },
  "å¯†åˆ©è€¶è²å°”è¾¾çœ": { "é‡Œå¡ç‘äºš": [], "ä¼Šæ³½å…‹é‡Œæ–¯æé‚£": [] },
  "å°”å–€å¸ƒå°¼åˆ©å…‹å·": { "è±è¯º": [], "æ°è¥¿å¡åˆ©äºš": [] },
  "å›½ä¸Šé“": { "å›½ä¸Š": [] },
  "å’Œè°é“": { "å›¾å“ˆè¾¾": [] },
  "åº“äºšæ‹‰çœ": { "æ©è´¡å¤š": [] },
  "ç“¦åŠ é©¬å°”è¥¿å—ç‰¹åŒº": { "è¨èµ«ç‰¹": [], "ç©†å·´æ‰å“ˆå§†": [], "é”¡å°”ç“¦": [], "æ³½åŠ ä¸‡": [], "å¡ä¼Šå›¾å§†": [], "é˜¿å·´å°”å¡": [] },
  "å·¥ä¸šé“": { "å·¥ä¸šåŸ": [], "å¤§å·¥åºœ": [], "ç”Ÿç‰©å·¥ç¨‹åŸ": [], "æ—¥åŒ–åŸ": [], "åŒ–å­¦åŸ": [], "ç‰©ç†åŸ": [] },
  "ç‡•é˜³é“": { "è§£æ”¾åºœ": [], "èµ¤å¡”åºœ": [] },
  "åŒ—æµ·çœ": { "æ–¯å¤§æ—æ ¼å‹’æ—äºš": [], "å…‹äºšä¿åŠ æ¸¯": [], "å·´æä¹Œ": [], "æ˜åˆ©å¯Ÿ": [] },
  "ä¸œæ–¹é“": { "å¤§åº­åºœ": ["ä¸´ç‰å¿","é‚¶æ°´åŒº"], "æå·åºœ": ["æ²¿å„å¿"], "é™çµåºœ": [], "èˆ¬è‹¥åºœ": [] },
  "å®‡è”ç‰¹åŒº": { "åœ£ä¸‡å¾·": [] },
  "ç€›å‡°ç‰¹åˆ«è¡Œæ”¿åŒº": { "é¹°å’€å¸‚": [], "æ²™é“å¸‚": [], "é¥¶æ±€æ¢å¸‚": [], "åŸä¸Šå¸‚": [], "éº“å·å¸‚": [] },
  "æ´¢ç”¸é“": { "ä¼šå—åºœ": [], "æ±Ÿå£åºœ": ["ä¹‚å®å¿","æ±ŸåŒ—å¿","æ´¢å·¦å¿"], "é«˜ç”¸åºœ": [] },
  "å·´å¨œé“": { "å·´å¨œåˆ©äºš": [], "æ¡‘æ ¼è€¶": [], "å¡å°¼å¾·": [], "é›…é›…äºšå¥‡": [], "è¨é›…è€¶": [], "æè‹": [], "å¡å¨œå·´å¤š": [] },
  "é•¿åº†é“": { "åœ£é‡‘åºœ": [], "æ›¹é˜³åºœ": ["åº†é˜³å¿"], "æ·±åŸåºœ": ["ç”Ÿç±³å¿","æ˜Ÿå¯åŒº"], "å¾¡å·åºœ": [] },
  "å…³å†…é“": { "å…´åº†åºœ": ["éš°å¿"] },
  "æ¢¦å¹»é“": { "è”å’Œåºœ": ["å¹»å·å¿"] },
  "æµ·è¥¿çœ": { "è¥¿æµ·å£": [], "ç‰¦åŸ": [], "è¾¹æµ·": [], "è¥¿å±±": [], "æè¥¿": ["è¥¿åŸŸè¾¹"] },
  "äº¬ååºœ": { "åŒ—åœ°å¿": ["äºä¹¡"], "è§‚é˜³å†›äº‹åŒº": [], "æ±Ÿè¾¹å¿": [], "æˆ·åå…¬ç¤¾": [], "åº†é˜´å¿": [], "é›æ³ åŒº": [], "é™µæ˜å…¬ç¤¾": [], "æ¹–è¥¿åŒº": ["ä¸´ä»“é•‡"] },
  "ä¸Šè‹ç»´åŸƒçœ": { "å¸ƒå°”ä»€ç»´æ ¼å‹’": [] },
  "æ¢µç½‘æ•™åŒº": { "æ¯—é˜‡è€¶åŸ": [], "éº¦è¿ªä»€å¸ƒ": [], "é“ä¸Š": [], "ä¼Šå°”é›…å…‹": [] },
  "è‹ä¸¹çœ": { "ç“œå“ˆå›¾å§†è‹å°”åŠ ": [] },
  "ä¸Šå’Œä¹é“": { "æ— æ˜åºœ": [], "ä¸Šå…ƒåºœ": ["åœ†æ˜å…¬ç¤¾","è‡ªåœ¨å¿"], "ä»“å—åºœ": ["æ»¨æ¹–å…¬ç¤¾","æ¹–å—åŒº","ä»“é˜´å¿"] },
  "æ±ŸåŒ—é“": { "æ¯›æ³½ä¸œåºœ": [], "ä¹Œç»´æ‹‰æ—¥å°¼ä¹Œå¯Ÿåˆ«åˆ—æ–¯å…‹": [] },
  "è¥¿æ±Ÿé“": { "æ²‚æ˜Œåºœ": ["æ˜Œè¥¿å¿","æ˜Œä¸œå¿"], "å’Œä¸œåºœ": [] },
  "å¿…æ”¯åºœ": { "ä¹…å¼¯å¿": [] },
  "æ¶§é—¨é“": { "å¿»æ˜¥åºœ": ["å¡”å¤å¿","æ¶§æºåŒº"], "æ±Ÿé—´åºœ": [] },
  "æ˜“å…³çœ": { "å…³ä¸­åºœ": [], "è¥¿ä¼šåºœ": ["é“¶é™µåŒº"] },
  "æºŸå·è·¯": { "å†¥å±±åºœ": [] },
  "å¤©ææ³•è·¯": { "æ˜æ­£åºœ": [] }
};
// ==== ç»“æŸ regions æ•°æ® ====
</script><script>
// ========== äº¤é€šè®¢ç¥¨ UI ä¸é€»è¾‘ ==========

// å¦‚æœé¡µé¢æ²¡æœ‰ showSec å‡½æ•°ï¼Œæä¾›ä¸€ä¸ªç®€å•å…¼å®¹å‡½æ•°ï¼ˆä»¥ä¾¿åœ¨ä¸ªäººé¡µå†…æ˜¾ç¤º/éšè— sectionï¼‰
if (typeof showSec !== 'function') {
  function showSec(id) {
    // éšè—æ‰€æœ‰ class="section"
    document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
    const el = document.getElementById(id);
    if (el) el.style.display = 'block';
  }
}

// å…ƒç´ å¿«æ·å¼•ç”¨
const selProvFrom = document.getElementById('sel-province-from');
const selPrefFrom = document.getElementById('sel-pref-from');
const selCountyFrom = document.getElementById('sel-county-from');
const selProvTo = document.getElementById('sel-province-to');
const selPrefTo = document.getElementById('sel-pref-to');
const selCountyTo = document.getElementById('sel-county-to');

const selMode = document.getElementById('sel-mode');
const depDate = document.getElementById('dep-date');
const depTime = document.getElementById('dep-time');
const selClass = document.getElementById('sel-class');
const passengerName = document.getElementById('passenger-name');
const passengerCount = document.getElementById('passenger-count');

const resultsDiv = document.getElementById('results');
const ordersList = document.getElementById('orders-list');

const btnSearch = document.getElementById('btn-search');
const btnClear = document.getElementById('btn-clear');

// åˆå§‹åŒ–çœåˆ—è¡¨ï¼ˆåŒå‘ï¼šå‡ºå‘ & ç›®çš„ï¼‰
function initProvinces() {
  const provinces = Object.keys(regions);
  fillSelect(selProvFrom, provinces, 'é€‰æ‹©çœ/é“');
  fillSelect(selProvTo, provinces, 'é€‰æ‹©çœ/é“');
  // è§¦å‘è”åŠ¨
  selProvFrom.dispatchEvent(new Event('change'));
  selProvTo.dispatchEvent(new Event('change'));
}

function fillSelect(sel, items, placeholder) {
  sel.innerHTML = '';
  if (placeholder) {
    const opt = document.createElement('option');
    opt.value = '';
    opt.textContent = placeholder;
    sel.appendChild(opt);
  }
  items.forEach(it => {
    const opt = document.createElement('option');
    opt.value = it;
    opt.textContent = it;
    sel.appendChild(opt);
  });
}

// çœ -> åºœ è”åŠ¨
selProvFrom.addEventListener('change', function() {
  const prov = this.value;
  const prefs = prov ? Object.keys(regions[prov]) : [];
  fillSelect(selPrefFrom, prefs, 'é€‰æ‹©åºœ');
  selPrefFrom.dispatchEvent(new Event('change'));
});
selProvTo.addEventListener('change', function() {
  const prov = this.value;
  const prefs = prov ? Object.keys(regions[prov]) : [];
  fillSelect(selPrefTo, prefs, 'é€‰æ‹©åºœ');
  selPrefTo.dispatchEvent(new Event('change'));
});

// åºœ -> å¿/åŒº è”åŠ¨
selPrefFrom.addEventListener('change', function() {
  const prov = selProvFrom.value;
  const pref = this.value;
  const counties = (prov && pref) ? (regions[prov][pref] || []) : [];
  fillSelect(selCountyFrom, counties, 'é€‰æ‹©å¿/åŒº');
});
selPrefTo.addEventListener('change', function() {
  const prov = selProvTo.value;
  const pref = this.value;
  const counties = (prov && pref) ? (regions[prov][pref] || []) : [];
  fillSelect(selCountyTo, counties, 'é€‰æ‹©å¿/åŒº');
});

// é‡ç½®æŒ‰é’®
btnClear.addEventListener('click', () => {
  selProvFrom.selectedIndex = 0;
  selPrefFrom.innerHTML = '';
  selCountyFrom.innerHTML = '';
  selProvTo.selectedIndex = 0;
  selPrefTo.innerHTML = '';
  selCountyTo.innerHTML = '';
  depDate.value = '';
  depTime.value = '';
  selMode.value = 'train';
  selClass.value = 'standard';
  passengerName.value = '';
  passengerCount.value = 1;
  resultsDiv.innerHTML = '';
});

// ç”Ÿæˆâ€œå¯è®¢è½¦æ¬¡/èˆªç­â€ â€”â€” å‰ç«¯æ ¹æ®é€‰æ‹©å³æ—¶ç”ŸæˆçœŸå®æ„Ÿç»“æœï¼ˆéåç«¯æ¨¡æ‹Ÿï¼‰
function generateTrips(params) {
  // å‚æ•°ï¼šfrom,to,mode,date,time,class,count,name
  // ç”Ÿæˆè§„åˆ™ï¼šæ ¹æ®çœ-åºœ-å¿çš„å­—ç¬¦ä¸² hash åŠæ—¶é—´ç”Ÿæˆè‹¥å¹²ç­æ¬¡ï¼Œä¿è¯æ¯æ¬¡åŒä¸€é…ç½®ç¨³å®šå¯å¤ç°
  const { from, to, mode, date, time, cls } = params;
  if (!from || !to || from===to) return [];

  // ç”ŸæˆåŸºå‡† seed
  const seedStr = `${from}|${to}|${mode}|${date}|${time}|${cls}`;
  let seed = 0;
  for (let i=0;i<seedStr.length;i++) seed = (seed * 131 + seedStr.charCodeAt(i)) >>> 0;

  const count = 3 + (seed % 4); // 3~6 ä¸ªç­æ¬¡
  const trips = [];
  for (let i=0;i<count;i++) {
    // ç”Ÿæˆæ—¶é—´ï¼ˆåœ¨ç”¨æˆ·æœŸæœ›æ—¶é—´é™„è¿‘ï¼‰
    const baseHour = time ? parseInt(time.split(':')[0],10) : 8 + (seed % 8);
    const hour = (baseHour + i) % 24;
    const minute = [0,15,30,45][(seed + i) % 4];
    const depart = `${String(hour).padStart(2,'0')}:${String(minute).padStart(2,'0')}`;

    // è€—æ—¶åŸºäºè·ç¦»ï¼ˆå­—ç¬¦ä¸²å·®å¼‚ï¼‰å’Œäº¤é€šå·¥å…·
    const distFactor = (Math.abs(hashCode(from) - hashCode(to)) % 10) + 1;
    let duration;
    if (mode === 'plane') duration = Math.max(1, Math.round(distFactor / 3)) + 1; // hours
    else if (mode === 'highspeed') duration = Math.max(1, Math.round(distFactor / 2)) + 1;
    else if (mode === 'ship') duration = Math.max(2, Math.round(distFactor * 1.5));
    else duration = Math.max(2, Math.round(distFactor)); // train

    // ç¥¨ä»·ç®€å•è®¡ç®—ï¼ˆåŸºäºæ—¶é•¿ã€èˆ±ä½ç³»æ•°ã€éšæœºseedï¼‰
    const classFactor = cls === 'first' ? 2.6 : (cls === 'comfort' ? 1.4 : 1.0);
    const priceBase = Math.max(10, duration * 20);
    const price = Math.round((priceBase + (seed % 50)) * classFactor);

    trips.push({
      id: `T-${Math.abs(seed ^ (i+1)).toString(36).toUpperCase()}`,
      departTime: depart,
      durationHours: duration,
      price: price,
      carrier: mode === 'plane' ? 'å¤©è¡Œèˆªç©º' : (mode === 'highspeed' ? 'é£é€Ÿé“è·¯' : (mode === 'ship' ? 'ç€›å‡°èˆªè¿' : 'å¤§å‡‰åˆ—è½¦')),
      seatsLeft: 10 + ((seed + i) % 40)
    });
  }
  return trips;
}

// è¾…åŠ© hash å‡½æ•°
function hashCode(str) {
  let h=0;
  for (let i=0;i<str.length;i++) h = (h<<5) - h + str.charCodeAt(i);
  return Math.abs(h);
}

// æ¸²æŸ“æœç´¢ç»“æœ
function renderTrips(trips, params) {
  resultsDiv.innerHTML = '';
  if (!trips.length) {
    resultsDiv.innerHTML = '<p style="color:#888;">æœªèƒ½ç”Ÿæˆå¯è®¢ç­æ¬¡ï¼ˆè¯·æ£€æŸ¥å‡ºå‘åœ°ä¸ç›®çš„åœ°æ˜¯å¦é€‰æ‹©æˆ–ä¸åŒï¼‰</p>';
    return;
  }
  trips.forEach(t => {
    const block = document.createElement('div');
    block.style.border = '1px solid #eee';
    block.style.padding = '10px';
    block.style.marginBottom = '10px';
    block.style.borderRadius = '6px';
    block.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div style="font-weight:600;color:#222;">${params.from} â†’ ${params.to}</div>
          <div style="color:#666;font-size:13px;margin-top:6px;">
            æ‰¿è¿ï¼š${t.carrier} Â· å‡ºå‘ï¼š${depDate.value || 'â€”'} ${t.departTime} Â· æ—¶é•¿ï¼š${t.durationHours} å°æ—¶
          </div>
        </div>
        <div style="text-align:right;">
          <div style="font-size:18px;color:#004d99;font-weight:700;">${t.price} é€šè¯</div>
          <div style="color:#888;font-size:13px;">ä½™ç¥¨ï¼š${t.seatsLeft}</div>
          <button style="margin-top:8px;padding:6px 10px;" onclick='bookTrip(${JSON.stringify(t).replace(/'/g,"\\'")}, ${JSON.stringify(params).replace(/'/g,"\\'")})'>é¢„è®¢</button>
        </div>
      </div>
    `;
    resultsDiv.appendChild(block);
  });
}

// é¢„è®¢å‡½æ•°ï¼ˆä¿å­˜åˆ° localStorageï¼‰
function bookTrip(trip, params) {
  const name = (passengerName.value || 'åŒ¿å');
  const count = Math.max(1, parseInt(passengerCount.value,10) || 1);
  const booking = {
    ticketNo: 'DL' + Date.now().toString(36).toUpperCase().slice(-8),
    tripId: trip.id,
    from: params.from, to: params.to,

</body>
</html>
