<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>è¶…å®‡å®™æ–‡æ˜ Â· æˆ‘çš„</title>
<style>
:root{--palace-red:#b71c1c;--palace-gold:#d4af37;--paper:#fdfaf6;--ink:#2c2c2c;--gap:20px;}
body{margin:0;font-family:Microsoft YaHei,serif;background:var(--paper);color:var(--ink);}
a{color:var(--palace-red);text-decoration:none;}
header{position:sticky;top:0;z-index:10;background:var(--palace-red);display:flex;justify-content:space-between;align-items:center;padding:10px 20px;box-shadow:0 2px 8px rgba(0,0,0,.1);}
header .logo{color:#fff;font-size:18px;font-weight:bold;}
header .user-bar{display:flex;align-items:center;gap:15px;color:#fff;font-size:14px;}
header button{padding:6px 12px;border:none;border-radius:4px;cursor:pointer;}
header .home-btn{background:#e8f3ff;color:#165dff;}
header .logout-btn{background:#f53f3f;color:#fff;}
.wrap{display:flex;max-width:1200px;margin:auto;padding:var(--gap);}
aside{width:320px;background:#fff;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,.05);padding:25px;}
main{flex:1;margin-left:var(--gap);display:flex;flex-direction:column;gap:var(--gap);}
.avatar-box{text-align:center;margin-bottom:25px;}
.avatar{width:100px;height:100px;border-radius:50%;background:#e8f3ff;display:flex;align-items:center;justify-content:center;font-size:40px;color:#165dff;margin:0 auto;position:relative;cursor:pointer;}
.avatar input{position:absolute;width:100%;height:100%;opacity:0;cursor:pointer;}
.info-item{margin-bottom:18px;font-size:14px;}
.info-item .label{color:#86909c;display:inline-block;width:80px;}
.edit-btn{width:100%;padding:10px;background:#f5f7fa;border:1px solid #e5e6eb;border-radius:4px;cursor:pointer;margin-top:10px;}
.section{display:none;background:#fff;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,.05);padding:25px;}
.section.active{display:block;}
.section h2{margin:0 0 20px;color:var(--palace-red);}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;}
.form-grid .full{grid-column:1/3;}
.form-grid label{display:block;font-size:14px;margin-bottom:6px;}
.form-grid input,.form-grid select,.form-grid textarea{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;}
button.submit{padding:8px 20px;background:var(--palace-red);color:#fff;border:none;border-radius:30px;cursor:pointer;}
.record-list{margin-top:15px;font-size:14px;}
.record-item{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px dashed #f2f3f5;}
#check-in{max-width:400px;margin:30px auto;padding:20px;border:2px solid var(--palace-gold);border-radius:8px;text-align:center;background:#fff;}
#check-in h3{margin:0 0 10px;color:var(--palace-red);}
#check-status{font-size:14px;color:#666;margin-bottom:15px;}
#btn-check{padding:10px 30px;font-size:16px;background:var(--palace-red);color:#fff;border:none;border-radius:30px;cursor:pointer;}
#btn-check:disabled{background:#999;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:100;}
.modal.show{display:flex;}
.modal-content{background:#fff;width:90%;max-width:600px;border-radius:8px;padding:25px;max-height:80vh;overflow-y:auto;}
.modal-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;}
.close-btn{font-size:24px;cursor:pointer;color:#999;}
.en{display:none;}
</style>
</head>
<body>

<header>
    <div class="logo">è¶…å®‡å®™æ–‡æ˜ Â· æˆ‘çš„</div>
    <div class="user-bar">
        <span id="currentUser">åŠ è½½ä¸­â€¦</span>
        <button class="home-btn" onclick="location.href='index.html'">è¿”å›é¦–é¡µ</button>
        <button class="logout-btn" onclick="location.href='login.html'">é€€å‡ºç™»å½•</button>
        <button onclick="toggleLang()">ä¸­/EN</button>
    </div>
</header>

<div class="wrap">
<aside>
    <div class="avatar-box">
        <div class="avatar">
    <img id="avatarImg" src="" 
         style="width:100%;height:100%;object-fit:cover;border-radius:50%;">
    <input type="file" accept="image/*" id="avatarUpload">
</div>
        <p style="font-size:13px;color:#86909c;">ç‚¹å‡»æ›´æ¢å¤´åƒ</p>
    </div>
    <div class="info-item"><span class="label">ç”¨æˆ·åï¼š</span><span id="userName">--</span></div>
    <div class="info-item"><span class="label">é€šè¯ï¼š</span><span id="userToken">--</span></div>
    <div class="info-item"><span class="label">æ–‡æ˜ç­‰çº§ï¼š</span><span id="userLevel">åˆå§‹æ¢ç´¢è€…</span></div>
    <div class="info-item"><span class="label">åŠ å…¥æ—¶é—´ï¼š</span><span>2024-01-01</span></div>
    <button class="edit-btn" onclick="editUserName()">ç¼–è¾‘ä¸ªäººä¿¡æ¯</button>

    <section id="check-in">
        <h3 class="zh">æ¯æ—¥ç­¾åˆ°</h3><h3 class="en">Daily Check-in</h3>
        <p id="check-status" class="zh">ä»Šæ—¥å°šæœªç­¾åˆ°</p><p id="check-status" class="en">Not checked in today</p>
        <button id="btn-check" onclick="doCheckIn()">ä¸€é”®ç­¾åˆ° / Check-in</button>
        <p class="zh" style="margin-top:10px;font-size:13px;color:#666;">è¿ç»­ç­¾åˆ°ï¼š<span id="streak">0</span> å¤©</p>
        <p class="en" style="margin-top:10px;font-size:13px;color:#666;">Streakï¼š<span id="streak">0</span> days</p>
    </section>
</aside>

<main>
    <nav style="display:flex;gap:15px;margin-bottom:var(--gap);">
        <button class="submit" onclick="showSec('account')">è´¦å·ç®¡ç†</button>
        <button class="submit" onclick="showSec('general')">é€šç”¨</button>
        <button class="submit" onclick="showSec('privacy')">éšç§</button>
        <button class="submit" onclick="showSec('gov')">æ”¿åŠ¡ä¿¡æ¯</button>
        <button class="submit" onclick="showSec('parliament')">è®®æ¡ˆæŠ•ç¥¨</button>
        <button class="submit" onclick="showSec('other')">å…¶ä»–</button>
        <button class="submit" onclick="showSec('citizen')">å…¬æ°‘äº’åŠ¨</button>
        <button class="submit" onclick="location.href='gen.html'">ç”µå·ç”Ÿæˆ</button>
        <button class="submit" onclick="location.href='transporttic.html'">äº¤é€šè®¢ç¥¨</button>
    </nav>

<script>
// å¤´åƒåŠŸèƒ½ JS
document.addEventListener("DOMContentLoaded", function () {
    const avatarImg = document.getElementById("avatarImg");
    const savedAvatar = localStorage.getItem("userAvatar");
    if (savedAvatar) {
        avatarImg.src = savedAvatar;
    } else {
        avatarImg.src = "data:image/svg+xml,\
<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100'>\
<rect width='100%' height='100%' fill='%23e8f3ff'/>\
<text x='50%' y='55%' font-size='45' text-anchor='middle' fill='%23165dff'>ğŸŒŒ</text>\
</svg>";
    }
});

document.getElementById("avatarUpload").addEventListener("change", function () {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
        const imgSrc = e.target.result;
        document.getElementById("avatarImg").src = imgSrc;
        localStorage.setItem("userAvatar", imgSrc);
    };
    reader.readAsDataURL(file);
});
</script>

    <!-- è´¦å·ç®¡ç† -->
    <section id="account" class="section active">
        <h2>è´¦å·ç®¡ç†</h2>
        <label>æ˜µç§°</label><input id="nickname" placeholder="æ˜µç§°">
        <label>å‡ºç”Ÿæ—¥æœŸ</label><input type="date" id="birthday">
        <label>ä¸ªäººç®€ä»‹</label><textarea id="bio" rows="3"></textarea>
        <button class="submit" onclick="saveAccount()">ä¿å­˜èµ„æ–™</button>
    </section>

    <!-- é€šç”¨ -->
    <section id="general" class="section">
        <h2>é€šç”¨è®¾ç½®</h2>
        <label>è¯­è¨€</label>
        <select id="lang"><option value="zh">ä¸­æ–‡</option><option value="en">English</option></select>
        <label>ä¸»é¢˜</label>
        <select id="theme"><option value="light">æµ…è‰²</option><option value="dark">æ·±è‰²</option></select>
        <label><input type="checkbox" id="notify"> å¯ç”¨ç³»ç»Ÿé€šçŸ¥</label>
        <button class="submit" onclick="saveGeneral()">ä¿å­˜è®¾ç½®</button>
    </section>

    <!-- éšç§ -->
    <section id="privacy" class="section">
        <h2>éšç§è®¾ç½®</h2>
        <label><input type="checkbox" id="public"> å…è®¸å…¶ä»–ç”¨æˆ·æŸ¥çœ‹æˆ‘çš„èµ„æ–™</label>
        <label><input type="checkbox" id="online"> æ˜¾ç¤ºåœ¨çº¿çŠ¶æ€</label>
        <div style="margin-top:15px;">
            <button class="submit" onclick="exportData()">å¯¼å‡ºæˆ‘çš„æ•°æ®</button>
            <button class="submit" onclick="if(confirm('ç¡®å®šæ°¸ä¹…æ³¨é”€ï¼Ÿ')){localStorage.clear();location.reload()}">æ°¸ä¹…æ³¨é”€</button>
        </div>
    </section>

    <!-- æ”¿åŠ¡ä¿¡æ¯ -->
    <section id="gov" class="section">
        <h2>æ”¿åŠ¡ä¿¡æ¯</h2>
        <div class="form-grid">
            <div><label>é€šè¯ç¼–å·</label><input id="tokenId" readonly></div>
            <div><label>ç­¾å‘æœºå…³</label><input id="issuer" readonly></div>
            <div><label>ç­¾å‘æ—¥æœŸ</label><input type="date" id="issueDate" readonly></div>
            <div><label>æœ‰æ•ˆæœŸè‡³</label><input type="date" id="expiryDate" readonly></div>
            <div class="full"><label>æ˜Ÿé™…é€šè¡Œæƒé™</label><textarea id="permissions" readonly></textarea></div>
        </div>
        <button class="submit" onclick="downloadCertificate()">ä¸‹è½½è¯ä»¶PDF</button>
    </section>
    
    <section id="parliament" class="section">
    <h2>è®®æ¡ˆæŠ•ç¥¨</h2>
    <div id="proposal-list">
        <!-- åŠ¨æ€ç”Ÿæˆçš„è®®æ¡ˆä¼šæ’å…¥è¿™é‡Œ -->
    </div>
</section>

    <!-- å…¶ä»– -->
    <section id="other" class="section">
        <h2>å…¶ä»–</h2>
        <label>æ”¶è—å¤¹</label><textarea id="favorites" rows="4" placeholder="ç²˜è´´æ”¶è—é“¾æ¥æˆ–æ–‡å­—"></textarea>
        <label>ç¬”è®°</label><textarea id="notes" rows="6" placeholder="ä¸ªäººç¬”è®°"></textarea>
        <label>å¿«æ·çŸ­è¯­</label><input id="quickPhrase" placeholder="ä¸€é”®å‘é€çš„çŸ­è¯­">
        <button class="submit" onclick="saveOther()">ä¿å­˜å…¶ä»–</button>
    </section>

    <!-- å…¬æ°‘äº’åŠ¨ -->
    <section id="citizen" class="section">
        <h2>å…¬æ°‘äº’åŠ¨åŠŸèƒ½</h2>
        <button class="submit" onclick="openModal('modal-apply')">é€šè¯ç”³é¢†æ¨¡æ‹Ÿ</button>
        <button class="submit" onclick="openModal('modal-calc')">åŸŸå¤–å…‘æ¢è®¡ç®—å™¨</button>
        <button class="submit" onclick="openModal('modal-query')">æ˜Ÿé™…å¤‡æ¡ˆæŸ¥è¯¢</button>
        <button class="submit" onclick="openModal('modal-feedback')">æ„è§åé¦ˆ</button>
        <button class="submit" onclick="openModal('modal-law')">æ³•å¾‹æ–‡ä»¶å¯¼èˆª</button>
    </section>

    <!-- æ¢ç´¢è®°å½• -->
    <section class="section active">
        <h2>è¶…å®‡å®™æ¢ç´¢è®°å½•</h2>
        <div class="record-list">
            <div class="record-item"><span>æµè§ˆã€Œè¶…å®‡å®™èµ·æºã€æ ¸å¿ƒæ–‡æ¡£</span><span class="record-time">2024-05-10 14:23</span></div>
            <div class="record-item"><span>è§£é”ã€Œæ˜Ÿé™…ç–†åŸŸã€åŸºç¡€æ˜Ÿå›¾</span><span class="record-time">2024-05-08 09:45</span></div>
            <div class="record-item"><span>é¦–æ¬¡å®Œæˆèº«ä»½éªŒè¯ç™»å½•</span><span class="record-time">2024-05-01 16:10</span></div>
        </div>
    </section>
</main><!-- ===== æ¡Œé¢å¸¸é©»åŠŸèƒ½é›†åˆ ===== -->
<section class="section active" style="margin-top:var(--gap);">
    <h2>å¿«æ·åŠŸèƒ½åŒº</h2>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px;">
        <button class="submit" onclick="openModal('modal-register')">æ³¨å†Œ/ç»­æœŸé€šè¯</button>
        <button class="submit" onclick="openModal('modal-special')">ç”³è¯·è®¿é—®ç‰¹åŒº</button>
        <button class="submit" onclick="openModal('modal-history')">å†å²è®°å½•</button>
        <button class="submit" onclick="openModal('modal-support')">åœ¨çº¿å®¢æœ</button>
        <button class="submit" onclick="openModal('modal-changepwd')">ä¿®æ”¹å¯†ç </button>
        <button class="submit" onclick="openModal('modal-bind')">ç»‘å®šæ‰‹æœº/é‚®ç®±</button>
        <button class="submit" onclick="openModal('modal-loginhist')">ç™»å½•å†å²</button>
    </div>
</section>

</div>

<!-- ===== å¼¹å±‚é›†åˆ ===== -->
<div id="modal-apply" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">é€šè¯ç”³é¢†æ¨¡æ‹Ÿ</span><span class="en">Token Application</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('ç”³é¢†æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label class="zh">å§“å</label><input required><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-calc" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">åŸŸå¤–å…‘æ¢è®¡ç®—å™¨</span><span class="en">Exchange Calculator</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <label class="zh">è¾“å…¥çºªå¿µå¸æ•°é‡</label><input type="number" id="coin" placeholder="100"><button class="submit" onclick="alert('å¯å…‘æ¢ '+(document.getElementById('coin').value*1.2)+' å¤–å¸ï¼ˆæ¨¡æ‹Ÿï¼‰')">è®¡ç®—</button>
</div></div>

<div id="modal-query" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ˜Ÿé™…å¤‡æ¡ˆæŸ¥è¯¢</span><span class="en">Record Query</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <input placeholder="è¾“å…¥é€šè¯ç¼–å·"><button class="submit" onclick="alert('æŸ¥è¯¢ç»“æœï¼šæ— é™åˆ¶é€šè¡Œï¼ˆæ¨¡æ‹Ÿï¼‰')">æŸ¥è¯¢</button>
</div></div>

<div id="modal-feedback" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ„è§åé¦ˆ</span><span class="en">Feedback</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼');closeModal();return false;"><select required><option value="">é€‰æ‹©æœºæ„</option><option>è§‰æ€§ç›‘å¯Ÿé™¢</option><option>è¶…å®‡å®™æŠ€æœ¯é™¢</option><option>åœ£ä¸–ç ”ç©¶åšè§ˆé™¢</option></select><textarea rows="4" required placeholder="è¯·å¡«å†™æ„è§"></textarea><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-law" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ³•å¾‹æ–‡ä»¶å¯¼èˆª</span><span class="en">Law Navigation</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <ul><li><a href="#">ç¬¬ä¸€ç«  æ€»åˆ™</a></li><li><a href="#">ç¬¬äºŒç«  é«˜ç»´å…¬æ°‘æƒ</a></li><li><a href="#">ç¬¬ä¸‰ç«  æ˜Ÿé™…é€šè¡Œ</a></li></ul>
</div></div>

<div id="modal-register" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ³¨å†Œ/ç»­æœŸé€šè¯</span><span class="en">Register/Renew</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('æäº¤æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label class="zh">å§“å</label><input required><label class="zh">èº«ä»½è¯å·ç </label><input required><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-special" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ç”³è¯·è®¿é—®ç‰¹åŒº</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('ç”³è¯·å·²æäº¤ï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>ç›®çš„åœ°åŒº</label><select><option>ç€›å‡°ç‰¹åŒº</option><option>å®‡è”ç‰¹åŒº</option></select><label>ç”³è¯·ç†ç”±</label><textarea rows="4" required></textarea><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-history" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">å†å²è®°å½•</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <table width="100%"><tr><th>æ—¥æœŸ</th><th>æ“ä½œ</th></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆä¸€æ—¥</td><td>æ³¨å†Œé€šè¯</td></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆäº”æ—¥</td><td>ç”³è¯·è®¿é—®ç€›å‡°ç‰¹åŒº</td></tr></table>
</div></div>

<div id="modal-support" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">åœ¨çº¿å®¢æœ</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('é—®é¢˜å·²æäº¤ï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>é—®é¢˜æè¿°</label><textarea rows="4" required></textarea><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-changepwd" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ä¿®æ”¹å¯†ç </span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('å¯†ç ä¿®æ”¹æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>å½“å‰å¯†ç </label><input type="password" required><label>æ–°å¯†ç </label><input type="password" required><label>ç¡®è®¤æ–°å¯†ç </label><input type="password" required><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-bind" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ç»‘å®šæ‰‹æœº/é‚®ç®±</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('ç»‘å®šæˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>æ‰‹æœºå·</label><input required><label>é‚®ç®±</label><input type="email" required><button class="submit" type="submit">ç»‘å®š</button></form>
</div></div>

<div id="modal-loginhist" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ç™»å½•å†å²</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <table width="100%"><tr><th>æ—¥æœŸ</th><th>ç™»å½•åœ°ç‚¹</th></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆäºŒæ—¥</td><td>äº¬å¸ˆå‡¡å¤šä¸‡</td></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆå››æ—¥</td><td>ç€›å‡°ç‰¹åŒº</td></tr></table>
</div></div>

<script>
/* ===== å·¥å…· ===== */
const $=s=>document.querySelector(s);
function getParam(){
    const p={};
    location.search.slice(1).split('&').forEach(kv=>{
        const [k,v]=kv.split('=');
        p[k]=v?decodeURIComponent(v):'';
    });
    return p;
}
/* ===== å®ˆé—¨ + èµ‹å€¼ ===== */
const params=getParam();
if(!params.token||!params.name){alert('è¯·å…ˆç™»å½•');location.href='login.html';}
else{
    $('#currentUser').textContent=params.name;
    $('#userName').textContent=params.name;
    $('#userToken').textContent=params.token;
}
/* ===== åŒè¯­ ===== */
function toggleLang(){
    const isZh=$('html').lang!=='en';
    document.querySelectorAll('.zh').forEach(e=>e.style.display=isZh?'none':'block');
    document.querySelectorAll('.en').forEach(e=>e.style.display=isZh?'block':'none');
    $('html').lang=isZh?'en':'zh';
}
/* ===== æ¿å— ===== */
function showSec(id){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    $('#'+id).classList.add('active');
}
/* ===== ç­¾åˆ° ===== */
const todayKey='checkIn_'+new Date().toISOString().slice(0,10);
function initCheck(){
    const done=localStorage.getItem(todayKey);
    const streak=localStorage.getItem('streakTotal')||'0';
    $('#streak').textContent=streak;
    if(done){$('#btn-check').disabled=true;$('#btn-check').textContent='å·²ç­¾åˆ°';$('#check-status').textContent='ä»Šæ—¥å·²ç­¾åˆ°';}
}
function doCheckIn(){
    localStorage.setItem(todayKey,'1');
    let total=parseInt(localStorage.getItem('streakTotal')||'0');
    localStorage.setItem('streakTotal',total+1);
    $('#streak').textContent=total+1;
    $('#btn-check').disabled=true;$('#btn-check').textContent='å·²ç­¾åˆ°';
    $('#check-status').textContent='ç­¾åˆ°æˆåŠŸï¼æ„¿æ‚¨ä»Šæ—¥æä¹åœ†æ»¡ã€‚';
}
initCheck();
/* ===== å¤´åƒ ===== */
$('#avatarUpload').addEventListener('change',e=>{
    const file=e.target.files[0];if(!file)return;
    const reader=new FileReader();
    reader.onload=ev=>{$('.avatar').style.backgroundImage=`url(${ev.target.result})`;localStorage.setItem('avatar',ev.target.result);}
    reader.readAsDataURL(file);
});
/* ===== ç¼–è¾‘ç”¨æˆ·å ===== */
function editUserName(){
    const name=prompt('æ–°ç”¨æˆ·å',params.name);
    if(name&&name.trim()){$('#userName').textContent=name;$('#currentUser').textContent=name;}
}
/* ===== ä¿å­˜ ===== */
function saveAccount(){
    localStorage.setItem('nickname',$('#nickname').value);
    localStorage.setItem('birthday',$('#birthday').value);
    localStorage.setItem('bio',$('#bio').value);
    alert('å·²ä¿å­˜ï¼ˆæœ¬åœ°ï¼‰');
}
function saveGeneral(){
    localStorage.setItem('lang',$('#lang').value);
    localStorage.setItem('theme',$('#theme').value);
    localStorage.setItem('notify',$('#notify').checked);
    alert('å·²ä¿å­˜ï¼ˆæœ¬åœ°ï¼‰');
}
function saveOther(){
    localStorage.setItem('favorites',$('#favorites').value);
    localStorage.setItem('notes',$('#notes').value);
    localStorage.setItem('quickPhrase',$('#quickPhrase').value);
    alert('å·²ä¿å­˜ï¼ˆæœ¬åœ°ï¼‰');
}
function exportData(){
    const data={
        account:{nickname:localStorage.getItem('nickname'),birthday:localStorage.getItem('birthday'),bio:localStorage.getItem('bio')},
        general:{lang:localStorage.getItem('lang'),theme:localStorage.getItem('theme'),notify:localStorage.getItem('notify')},
        other:{favorites:localStorage.getItem('favorites'),notes:localStorage.getItem('notes'),quickPhrase:localStorage.getItem('quickPhrase')}
    };
    const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');a.href=url;a.download='myData.json';a.click();URL.revokeObjectURL(url);
}
function downloadCertificate(){
    const cert={name:localStorage.getItem('nickname')||'ç”¨æˆ·',tokenId:'DLR-2025-0001',issuer:'ä¸­å¤®åˆ¶è¯å‘è¯æ€»ç½²',issueDate:'2025-01-01',expiryDate:'2034-01-01',permissions:'å‡¡å¤šã€ç€›å‡°ã€å—æè¾¹åŒºéƒ½æŠ¤ã€å¦‚æ„è·¯å…¨åŸŸé€šè¡Œ'};
    const blob=new Blob([JSON.stringify(cert,null,2)],{type:'application/pdf'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');a.href=url;a.download='certificate.json';a.click();URL.revokeObjectURL(url);
}
/* ===== å¼¹å±‚ ===== */
function openModal(id){$('#'+id).classList.add('show');}
function closeModal(){document.querySelectorAll('.modal').forEach(m=>m.classList.remove('show'));}
/* ===== æœåŠ¡å…¥å£ ===== */
function registerRenew(){openModal('modal-register');}
function applySpecialAccess(){openModal('modal-special');}
function viewHistory(){openModal('modal-history');}
function onlineSupport(){openModal('modal-support');}
function changePassword(){openModal('modal-changepwd');}
function bindPhoneEmail(){openModal('modal-bind');}
function viewLoginHistory(){openModal('modal-loginhist');}
</script>
<script>
function generateProposal(id) {
    const titles = [
        "å¤§å‡‰å›½åŸºç¡€è®¾æ–½å»ºè®¾",
        "è¶…å®‡å®™æ–‡æ˜ç§‘ç ”è®¡åˆ’",
        "å…¨æ°‘æ–‡åŒ–æ•™è‚²æå‡",
        "ç”Ÿæ€ä¿æŠ¤ä¸è‡ªç„¶æ³•ç»´æŠ¤",
        "å›½æ°‘å¹¸ç¦æŒ‡æ•°æå‡é¡¹ç›®",
        "å…¬å…±å®‰å…¨ä¸é˜²æŠ¤ç³»ç»Ÿä¼˜åŒ–"
    ];
    const descs = [
        "æå‡å…¨å›½å„åœ°åŸºç¡€è®¾æ–½å»ºè®¾æ°´å¹³",
        "èµ„åŠ©è¶…å®‡å®™æ–‡æ˜ç§‘ç ”é¡¹ç›®",
        "æ™®åŠæ–‡åŒ–æ•™è‚²ï¼Œæå‡æ–‡æ˜ç´ å…»",
        "åŠ å¼ºç”Ÿæ€ä¿æŠ¤ä¸è‡ªç„¶æ³•æ‰§è¡Œ",
        "æ”¹å–„æ°‘ç”Ÿï¼Œæé«˜å…¬æ°‘å¹¸ç¦æ„Ÿ",
        "å®Œå–„å…¬å…±å®‰å…¨ä¸é˜²æŠ¤ä½“ç³»"
    ];
    const t = titles[Math.floor(Math.random() * titles.length)];
    const d = descs[Math.floor(Math.random() * descs.length)];
    
    return { id, title: t, desc: d };
}

function renderProposals(count = 5) {
    const container = document.getElementById("proposal-list");
    container.innerHTML = "";
    for (let i = 1; i <= count; i++) {
        const p = generateProposal(i);
        const div = document.createElement("div");
        div.className = "proposal-item";
        div.style.borderBottom = "1px dashed #f2f3f5";
        div.style.padding = "10px 0";
        div.innerHTML = `
            <p><strong>è®®æ¡ˆæ ‡é¢˜ï¼š</strong>${p.title}</p>
            <p><strong>ç®€ä»‹ï¼š</strong>${p.desc}</p>
            <button onclick="voteProposal(${p.id}, 'yes')">æ”¯æŒ âœ…</button>
            <button onclick="voteProposal(${p.id}, 'no')">åå¯¹ âŒ</button>
        `;
        container.appendChild(div);
    }
}

function voteProposal(id, choice) {
    alert(`ä½ å¯¹è®®æ¡ˆ ${id} çš„æŠ•ç¥¨ï¼š${choice}`);
}

// é¡µé¢åŠ è½½æ—¶ç”Ÿæˆè®®æ¡ˆ
document.addEventListener("DOMContentLoaded", function () {
    renderProposals(5);
});

</script>
</body>
</html>
