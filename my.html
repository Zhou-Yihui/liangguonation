<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>è¶…å®‡å®™æ–‡æ˜ Â· æˆ‘çš„</title>
<style>
:root{--palace-red:#b71c1c;--palace-gold:#d4af37;--paper:#fdfaf6;--ink:#2c2c2c;--gap:20px;}
body{margin:0;font-family:Microsoft YaHei,serif;background:var(--paper);color:var(--ink);}
a{color:var(--palace-red);text-decoration:none;}
header{position:sticky;top:0;z-index:10;background:var(--palace-red);display:flex;justify-content:space-between;align-items:center;padding:10px 20px;box-shadow:0 2px 8px rgba(0,0,0,.1);}
header .logo{color:#fff;font-size:18px;font-weight:bold;}
header .user-bar{display:flex;align-items:center;gap:15px;color:#fff;font-size:14px;}
header button{padding:6px 12px;border:none;border-radius:4px;cursor:pointer;}
header .home-btn{background:#e8f3ff;color:#165dff;}
header .logout-btn{background:#f53f3f;color:#fff;}
.wrap{display:flex;max-width:1200px;margin:auto;padding:var(--gap);}
aside{width:320px;background:#fff;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,.05);padding:25px;}
main{flex:1;margin-left:var(--gap);display:flex;flex-direction:column;gap:var(--gap);}
.avatar-box{text-align:center;margin-bottom:25px;}
.avatar{width:100px;height:100px;border-radius:50%;background:#e8f3ff;display:flex;align-items:center;justify-content:center;font-size:40px;color:#165dff;margin:0 auto;position:relative;cursor:pointer;}
.avatar input{position:absolute;width:100%;height:100%;opacity:0;cursor:pointer;}
.info-item{margin-bottom:18px;font-size:14px;}
.info-item .label{color:#86909c;display:inline-block;width:80px;}
.edit-btn{width:100%;padding:10px;background:#f5f7fa;border:1px solid #e5e6eb;border-radius:4px;cursor:pointer;margin-top:10px;}
.section{display:none;background:#fff;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,.05);padding:25px;}
.section.active{display:block;}
.section h2{margin:0 0 20px;color:var(--palace-red);}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;}
.form-grid .full{grid-column:1/3;}
.form-grid label{display:block;font-size:14px;margin-bottom:6px;}
.form-grid input,.form-grid select,.form-grid textarea{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;}
button.submit{padding:8px 20px;background:var(--palace-red);color:#fff;border:none;border-radius:30px;cursor:pointer;}
.record-list{margin-top:15px;font-size:14px;}
.record-item{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px dashed #f2f3f5;}
#check-in{max-width:400px;margin:30px auto;padding:20px;border:2px solid var(--palace-gold);border-radius:8px;text-align:center;background:#fff;}
#check-in h3{margin:0 0 10px;color:var(--palace-red);}
#check-status{font-size:14px;color:#666;margin-bottom:15px;}
#btn-check{padding:10px 30px;font-size:16px;background:var(--palace-red);color:#fff;border:none;border-radius:30px;cursor:pointer;}
#btn-check:disabled{background:#999;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:100;}
.modal.show{display:flex;}
.modal-content{background:#fff;width:90%;max-width:600px;border-radius:8px;padding:25px;max-height:80vh;overflow-y:auto;}
.modal-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;}
.close-btn{font-size:24px;cursor:pointer;color:#999;}
.en{display:none;}
</style>
</head>
<body>

<header>
    <div class="logo">è¶…å®‡å®™æ–‡æ˜ Â· æˆ‘çš„</div>
    <div class="user-bar">
        <span id="currentUser">åŠ è½½ä¸­â€¦</span>
        <button class="home-btn" onclick="location.href='index.html'">è¿”å›é¦–é¡µ</button>
        <button class="logout-btn" onclick="location.href='login.html'">é€€å‡ºç™»å½•</button>
        <button onclick="toggleLang()">ä¸­/EN</button>
    </div>
</header>

<div class="wrap">
<aside>
    <div class="avatar-box">
        <div class="avatar">
    <img id="avatarImg" src="" 
         style="width:100%;height:100%;object-fit:cover;border-radius:50%;">
    <input type="file" accept="image/*" id="avatarUpload">
</div>
        <p style="font-size:13px;color:#86909c;">ç‚¹å‡»æ›´æ¢å¤´åƒ</p>
    </div>
    <div class="info-item"><span class="label">ç”¨æˆ·åï¼š</span><span id="userName">--</span></div>
    <div class="info-item"><span class="label">é€šè¯ï¼š</span><span id="userToken">--</span></div>
    <div class="info-item"><span class="label">æ–‡æ˜ç­‰çº§ï¼š</span><span id="userLevel">åˆå§‹æ¢ç´¢è€…</span></div>
    <div class="info-item"><span class="label">åŠ å…¥æ—¶é—´ï¼š</span><span>2024-01-01</span></div>
    <button class="edit-btn" onclick="editUserName()">ç¼–è¾‘ä¸ªäººä¿¡æ¯</button>

    <section id="check-in">
        <h3 class="zh">æ¯æ—¥ç­¾åˆ°</h3><h3 class="en">Daily Check-in</h3>
        <p id="check-status" class="zh">ä»Šæ—¥å°šæœªç­¾åˆ°</p><p id="check-status" class="en">Not checked in today</p>
        <button id="btn-check" onclick="doCheckIn()">ä¸€é”®ç­¾åˆ° / Check-in</button>
        <p class="zh" style="margin-top:10px;font-size:13px;color:#666;">è¿ç»­ç­¾åˆ°ï¼š<span id="streak">0</span> å¤©</p>
        <p class="en" style="margin-top:10px;font-size:13px;color:#666;">Streakï¼š<span id="streak">0</span> days</p>
    </section>
</aside>

<main>
    <nav style="display:flex;gap:15px;margin-bottom:var(--gap);">
        <button class="submit" onclick="showSec('account')">è´¦å·ç®¡ç†</button>
        <button class="submit" onclick="showSec('general')">é€šç”¨</button>
        <button class="submit" onclick="showSec('privacy')">éšç§</button>
        <button class="submit" onclick="showSec('gov')">æ”¿åŠ¡ä¿¡æ¯ğŸ›ï¸</button>
        <button class="submit" onclick="showSec('parliament')">è®®æ¡ˆæŠ•ç¥¨ğŸ§¾</button>
        <button class="submit" onclick="showSec('card')">ä¸€å¡é€šğŸ’³</button>
        <button class="submit" onclick="showSec('other')">å…¶ä»–</button>
        <button class="submit" onclick="showSec('citizen')">å…¬æ°‘äº’åŠ¨ğŸ“²</button>
        <button class="submit" onclick="location.href='gen.html'">ç”µå·ç”Ÿæˆâ˜ï¸</button>
        <button class="submit" onclick="location.href='supportnew.html'">äº¤é€šè®¢ç¥¨ğŸ«</button>
        <button class="submit" onclick="location.href='keyletter.html'">é›…è¨€è¾“å…¥æ³•ğŸ“–</button>
        <button class="submit" onclick="location.href='bankofLC.html'">å¤§å‡‰é“¶è¡ŒğŸ¦</button>
    </nav>

<script>
// å¤´åƒåŠŸèƒ½ JS
document.addEventListener("DOMContentLoaded", function () {
    const avatarImg = document.getElementById("avatarImg");
    const savedAvatar = localStorage.getItem("userAvatar");
    if (savedAvatar) {
        avatarImg.src = savedAvatar;
    } else {
        avatarImg.src = "data:image/svg+xml,\
<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100'>\
<rect width='100%' height='100%' fill='%23e8f3ff'/>\
<text x='50%' y='55%' font-size='45' text-anchor='middle' fill='%23165dff'>ğŸŒŒ</text>\
</svg>";
    }
});

document.getElementById("avatarUpload").addEventListener("change", function () {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
        const imgSrc = e.target.result;
        document.getElementById("avatarImg").src = imgSrc;
        localStorage.setItem("userAvatar", imgSrc);
    };
    reader.readAsDataURL(file);
});
</script>

    <!-- è´¦å·ç®¡ç† -->
    <section id="account" class="section active">
    <div id="token-tools"></div><div id="token-tools" style="margin-top:30px;padding:20px;border:2px solid var(--palace-gold);border-radius:8px;background:#fff;">
    <h3>é€šè¯ç¼–ç åŠ å¯†/è§£å¯†å·¥å…·</h3>

    <div style="margin-bottom:20px;">
        <h4>åŠ å¯†ç”Ÿæˆé€šè¯ç¼–ç </h4>
        <div class="form-grid">
            <label>é€šè¯ç±»å‹ç </label>
            <input type="text" id="encType" value="T">
            
            <label>è¡Œæ”¿åŒºç¼–ç </label>
            <input type="text" id="encRegion" value="010130">
            
            <label>å‡ºç”Ÿæ—¥æœŸ (å›½å†)</label>
            <div>
                å¹´ <input type="number" id="birthYear" min="1" value="1" style="width:60px;">
                æœˆ <input type="number" id="birthMonth" min="1" max="28" value="1" style="width:60px;">
                æ—¥ <input type="number" id="birthDay" min="1" max="116" value="1" style="width:60px;">
            </div>
            
            <label>é¢†è¯æ—¥æœŸ (å›½å†)</label>
            <div>
                å¹´ <input type="number" id="certYear" min="1" value="1884" style="width:60px;">
                æœˆ <input type="number" id="certMonth" min="1" max="28" value="3" style="width:60px;">
                æ—¥ <input type="number" id="certDay" min="1" max="116" value="84" style="width:60px;">
            </div>
            
            <label>ç‰©ç§ç ï¼ˆå«æ€§åˆ«ï¼‰</label>
            <input type="text" id="species" value="21">
            
            <label>é¡ºåºç </label>
            <input type="number" id="seqCode" min="1" value="1">
        </div>
        <button class="submit" onclick="generateToken()">ç”Ÿæˆé€šè¯ç¼–ç </button>
        <p>ç”Ÿæˆç¼–ç ï¼š<span id="genToken" style="font-weight:bold;color:var(--palace-red);">--</span></p>
    </div>

    <div style="margin-top:30px;">
        <h4>è§£å¯†é€šè¯ç¼–ç </h4>
        <input type="text" id="decodeInput" placeholder="è¾“å…¥é€šè¯ç¼–ç " style="width:300px;padding:6px;border:1px solid #ccc;border-radius:4px;">
        <button class="submit" onclick="decodeToken()">è§£ç </button>
        <div id="decodeOutput" style="margin-top:10px;font-size:14px;color:#165dff;"></div>
    </div>
</div>

<script>
// ------------------ å›½å†æ—¥æœŸåˆ°å°æ—¶æ•° ------------------
function toHours(y, m, d) {
    return ((y - 1) * 28 * 116 + (m - 1) * 116 + (d - 1)) * 58;
}

// ------------------ Base36å‹ç¼© ------------------
function toBase36(n) {
    return n.toString(36).toUpperCase();
}
function fromBase36(str) {
    return parseInt(str, 36);
}

// ------------------ æ ¡éªŒç ç”Ÿæˆ ------------------
function getCheckCode(tokenWithoutCheck) {
    let sum = 0;
    for (let i = 0; i < tokenWithoutCheck.length; i++) {
        sum += tokenWithoutCheck.charCodeAt(i);
    }
    return (sum % 36).toString(36).toUpperCase();
}

// ------------------ ç”Ÿæˆé€šè¯ç¼–ç  ------------------
function generateToken() {
    const type = document.getElementById('encType').value.trim();
    const region = document.getElementById('encRegion').value.trim();
    const species = document.getElementById('species').value.trim();
    const seq = parseInt(document.getElementById('seqCode').value);

    const bY = parseInt(document.getElementById('birthYear').value);
    const bM = parseInt(document.getElementById('birthMonth').value);
    const bD = parseInt(document.getElementById('birthDay').value);
    const cY = parseInt(document.getElementById('certYear').value);
    const cM = parseInt(document.getElementById('certMonth').value);
    const cD = parseInt(document.getElementById('certDay').value);

    const birthHrs = toHours(bY,bM,bD);
    const certHrs = toHours(cY,cM,cD);

    // æ—¥æœŸå‹ç¼©ä¸ºBase36
    const dateCode = toBase36(birthHrs + certHrs);

    const tokenWithoutCheck = type + region + dateCode + species + seq;
    const check = getCheckCode(tokenWithoutCheck);

    const finalToken = tokenWithoutCheck + check;
    document.getElementById('genToken').innerText = finalToken;
}

// ------------------ è§£ç é€šè¯ç¼–ç  ------------------
function decodeToken() {
    const input = document.getElementById('decodeInput').value.trim().toUpperCase();
    if(!input){document.getElementById('decodeOutput').innerText='è¯·è¾“å…¥ç¼–ç ï¼';return;}

    // å‡è®¾æ ¼å¼: ç±»å‹(1)+è¡Œæ”¿åŒº(6)+æ—¥æœŸå‹ç¼©(ä»»æ„é•¿åº¦)+ç‰©ç§(2)+é¡ºåºç (ä»»æ„)+æ ¡éªŒ(1)
    const type = input[0];
    const region = input.substr(1,6);
    const check = input.slice(-1);
    const speciesSeq = input.slice(-3,-1);
    const seq = input.slice(-2,-1);
    const dateCode = input.substr(7,input.length-7-3); // ä¸­é—´éƒ¨åˆ†æ˜¯æ—¥æœŸå‹ç¼©

    // æ ¡éªŒç éªŒè¯
    const tokenWithoutCheck = input.slice(0,-1);
    const expectedCheck = getCheckCode(tokenWithoutCheck);
    if(expectedCheck !== check){document.getElementById('decodeOutput').innerText='æ ¡éªŒç é”™è¯¯ï¼';return;}

    const totalHrs = fromBase36(dateCode);
    let y=1,m=1,d=1;
    let hrs = totalHrs;
    y = Math.floor(hrs/(28*116*58)) +1;
    hrs %= (28*116*58);
    m = Math.floor(hrs/(116*58)) +1;
    hrs %= (116*58);
    d = Math.floor(hrs/58)+1;

    document.getElementById('decodeOutput').innerText=
        `é€šè¯ç±»å‹: ${type}\nè¡Œæ”¿åŒºç¼–ç : ${region}\nå›½å†æ—¥æœŸåˆè®¡: å¹´${y} æœˆ${m} æ—¥${d}\nç‰©ç§ç : ${speciesSeq}\né¡ºåºç : ${seq}\næ ¡éªŒç : ${check}`;
}
</script>
        <h2>è´¦å·ç®¡ç†</h2>
        <label>æ˜µç§°</label><input id="nickname" placeholder="æ˜µç§°">
        <label>å‡ºç”Ÿæ—¥æœŸ</label><input type="date" id="birthday">
        <label>ä¸ªäººç®€ä»‹</label><textarea id="bio" rows="3"></textarea>
        <button class="submit" onclick="saveAccount()">ä¿å­˜èµ„æ–™</button>
    </section>

    <!-- é€šç”¨ -->
    <section id="general" class="section">
        <h2>é€šç”¨è®¾ç½®</h2>
        <label>è¯­è¨€</label>
        <select id="lang"><option value="zh">ä¸­æ–‡</option><option value="en">English</option></select>
        <label>ä¸»é¢˜</label>
        <select id="theme"><option value="light">æµ…è‰²</option><option value="dark">æ·±è‰²</option></select>
        <label><input type="checkbox" id="notify"> å¯ç”¨ç³»ç»Ÿé€šçŸ¥</label>
        <button class="submit" onclick="saveGeneral()">ä¿å­˜è®¾ç½®</button>
    </section>

    <!-- éšç§ -->
    <section id="privacy" class="section">
        <h2>éšç§è®¾ç½®</h2>
        <label><input type="checkbox" id="public"> å…è®¸å…¶ä»–ç”¨æˆ·æŸ¥çœ‹æˆ‘çš„èµ„æ–™</label>
        <label><input type="checkbox" id="online"> æ˜¾ç¤ºåœ¨çº¿çŠ¶æ€</label>
        <div style="margin-top:15px;">
            <button class="submit" onclick="exportData()">å¯¼å‡ºæˆ‘çš„æ•°æ®</button>
            <button class="submit" onclick="if(confirm('ç¡®å®šæ°¸ä¹…æ³¨é”€ï¼Ÿ')){localStorage.clear();location.reload()}">æ°¸ä¹…æ³¨é”€</button>
        </div>
    </section>

    <!-- æ”¿åŠ¡ä¿¡æ¯ -->
    <section id="gov" class="section">
        <h2>æ”¿åŠ¡ä¿¡æ¯</h2>
        <div class="form-grid">
            <div><label>é€šè¯ç¼–å·</label><input id="tokenId" readonly></div>
            <div><label>ç­¾å‘æœºå…³</label><input id="issuer" readonly></div>
            <div><label>ç­¾å‘æ—¥æœŸ</label><input type="date" id="issueDate" readonly></div>
            <div><label>æœ‰æ•ˆæœŸè‡³</label><input type="date" id="expiryDate" readonly></div>
            <div class="full"><label>æ˜Ÿé™…é€šè¡Œæƒé™</label><textarea id="permissions" readonly></textarea></div>
        </div>
        <button class="submit" onclick="downloadCertificate()">ä¸‹è½½è¯ä»¶PDF</button>
    </section>
    
    <!-- ä¸€å¡é€š -->
<section id="card" class="section">
    <h2>å¤§å‡‰å›½ä¼—ç”Ÿä¸€å¡é€š</h2>
    <!-- åŠå¡è¡¨å• -->
    <div id="card-apply-form" style="display:block;margin-bottom:30px;padding:20px;border:1px solid #e5e6eb;border-radius:8px;">
        <h3 style="color:var(--palace-red);margin-top:0;">åŠå¡ç”³è¯·</h3>
        <div class="form-grid">
            <div>
                <label>çœŸå®å§“åï¼ˆä¸é€šè¯ä¸€è‡´ï¼‰</label>
                <input type="text" id="card-realname" required placeholder="è¯·è¾“å…¥çœŸå®å§“å">
            </div>
            <div>
                <label>é€šè¯ç¼–å·ï¼ˆè‡ªåŠ¨å¡«å……ï¼‰</label>
                <input type="text" id="card-token" readonly placeholder="é€šè¯ç¼–å·">
            </div>
            <div>
                <label>è”ç³»ç”µè¯</label>
                <input type="tel" id="card-phone" required placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯">
            </div>
            <div>
                <label>æˆ·ç±æ‰€åœ¨åœ°</label>
                <input type="text" id="card-address" required placeholder="å¦‚ï¼šäº¬å¸ˆå‡¡å¤šåŸå…´åº†åŒº">
            </div>
            <div class="full">
                <label>åŠå¡ç±»å‹</label>
                <select id="card-type" required>
                    <option value="standard">æ ‡å‡†å¡ï¼ˆå«äº¤é€š+ç¤¾ä¿+åŒ»ä¿åŠŸèƒ½ï¼‰</option>
                    <option value="senior">è€å¹´å¡ï¼ˆé¢å¤–äº«ä¼˜æƒ æ”¿ç­–ï¼‰</option>
                    <option value="student">å­¦ç”Ÿå¡ï¼ˆé¢å¤–äº«æ•™è‚²ç›¸å…³åŠŸèƒ½ï¼‰</option>
                </select>
            </div>
        </div>
        <button class="submit" style="margin-top:15px;" onclick="submitCardApplication()">æäº¤åŠå¡ç”³è¯·</button>
    </div>

    <!-- å·²åŠå¡å±•ç¤º -->
    <div id="card-display" style="display:none;position:relative;width:600px;height:350px;margin:20px auto;border-radius:12px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,0.15);">
        <!-- å¡ç‰‡èƒŒæ™¯ï¼ˆè™šåŒ–å¤„ç†ï¼‰ -->
        <div style="position:absolute;top:0;left:0;width:100%;height:100%;">
            <img src="1765726205835.png" style="width:100%;height:100%;object-fit:cover;filter:blur(2px);opacity:0.8;">
        </div>
        <!-- å¡ç‰‡æ ‡é¢˜å›¾ -->
        <div style="position:absolute;top:15px;left:20px;width:80px;height:30px;">
            <img src="IMG_20251214_232748.jpg" style="width:100%;height:100%;object-fit:contain;">
        </div>
        <!-- å¡ç‰‡ä¿¡æ¯å±‚ -->
        <div style="position:absolute;top:0;left:0;width:100%;height:100%;padding:20px;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,0.5);">
            <div style="margin-top:60px;">
                <p style="font-size:18px;margin:5px 0;"><strong>æŒå¡äººï¼š</strong><span id="card-display-name">--</span></p>
                <p style="font-size:16px;margin:5px 0;"><strong>é€šè¯ç¼–å·ï¼š</strong><span id="card-display-token">--</span></p>
                <p style="font-size:16px;margin:5px 0;"><strong>å¡ç‰‡ç±»å‹ï¼š</strong><span id="card-display-type">æ ‡å‡†å¡</span></p>
                <p style="font-size:14px;margin:5px 0;"><strong>åŠå¡æ—¥æœŸï¼š</strong><span id="card-display-date">--</span></p>
                <p style="font-size:14px;margin:5px 0;"><strong>çŠ¶æ€ï¼š</strong><span id="card-display-status" style="color:#4cd964;">æ­£å¸¸ä½¿ç”¨</span></p>
            </div>
            <div style="position:absolute;bottom:20px;right:20px;text-align:right;">
                <p style="font-size:12px;margin:2px 0;">å¤§å‡‰å›½ä¼—ç”Ÿä¸€å¡é€šç®¡ç†ä¸­å¿ƒ</p>
                <p style="font-size:11px;margin:2px 0;">å”¯ä¸€æ ‡è¯†ï¼š<span id="card-unique-id">--</span></p>
            </div>
        </div>
        <!-- å¡ç‰‡æ“ä½œæŒ‰é’® -->
        <button class="submit" style="position:absolute;top:20px;right:20px;padding:6px 15px;font-size:14px;" onclick="cancelCard()">è§£é™¤å¡ç‰‡</button>
    </div>

    <!-- å¡ç‰‡ä½¿ç”¨ä¿¡æ¯ -->
    <div id="card-info" style="display:none;margin-top:30px;">
        <h3 style="color:var(--palace-red);">å¡ç‰‡ä½¿ç”¨ä¿¡æ¯</h3>
        <!-- ä½¿ç”¨èŒƒå›´ -->
        <div style="margin-bottom:20px;padding:15px;background:#f5f7fa;border-radius:8px;">
            <h4 style="margin-top:0;color:#333;">é€‚ç”¨èŒƒå›´</h4>
            <ul style="margin:5px 0;padding-left:20px;">
                <li>å…¬å…±äº¤é€šï¼šæ˜Ÿé™…è½¨é“åˆ—è½¦ã€åŒºåŸŸç©¿æ¢­å·´å£«ã€ç©ºä¸­é€šå‹¤æœº</li>
                <li>ç¤¾ä¿æœåŠ¡ï¼šå…»è€é‡‘é¢†å–ã€å¤±ä¸šä¿éšœç”³é¢†ã€ç¤¾ä¿ä¿¡æ¯æŸ¥è¯¢</li>
                <li>åŒ»ç–—æœåŠ¡ï¼šåŒ»é™¢å°±è¯Šç»“ç®—ã€åŒ»ä¿è¯å“è´­ä¹°ã€å¥åº·æ¡£æ¡ˆæŸ¥è¯¢</li>
                <li>å…¬å…±æœåŠ¡ï¼šæ”¿åŠ¡å¤§å…åŠäº‹ã€å›¾ä¹¦é¦†å€Ÿé˜…ã€å…¬å…±åœºé¦†å…¥åœº</li>
                <li>æ°‘ç”ŸæœåŠ¡ï¼šæ°´ç”µç‡ƒæ°”ç¼´è´¹ã€ç¤¾åŒºæœåŠ¡åŠç†ã€ç¦åˆ©è¡¥è´´é¢†å–</li>
            </ul>
        </div>
        <!-- æ³¨æ„äº‹é¡¹ -->
        <div style="margin-bottom:20px;padding:15px;background:#fff8e1;border-radius:8px;border-left:3px solid var(--palace-gold);">
            <h4 style="margin-top:0;color:#333;">æ³¨æ„äº‹é¡¹</h4>
            <ul style="margin:5px 0;padding-left:20px;">
                <li>æœ¬å¡ä¸é€šè¯ç»‘å®šï¼Œä»…é™æœ¬äººä½¿ç”¨ï¼Œä¸å¾—è½¬å€Ÿä»–äºº</li>
                <li>å¡ç‰‡ä¸¢å¤±è¯·åŠæ—¶é€šè¿‡æ”¿åŠ¡ç³»ç»ŸæŒ‚å¤±ï¼Œé¿å…æƒç›Šå—æŸ</li>
                <li>å¡ç‰‡æœ‰æ•ˆæœŸä¸é€šè¯ä¸€è‡´ï¼Œåˆ°æœŸå‰éœ€åŠç†ç»­æœŸæ‰‹ç»­</li>
                <li>ä½¿ç”¨æ—¶éœ€ä¿æŒå¡ç‰‡èŠ¯ç‰‡æ¸…æ´ï¼Œé¿å…åˆ®æŸæˆ–é«˜æ¸©ç¯å¢ƒ</li>
                <li>ç¤¾ä¿ã€åŒ»ä¿åŠŸèƒ½éœ€å®Œæˆçº¿ä¸‹æ¿€æ´»ï¼Œæ¿€æ´»ç‚¹å¯é€šè¿‡æ”¿åŠ¡ç³»ç»ŸæŸ¥è¯¢</li>
            </ul>
        </div>
        <!-- ä½¿ç”¨å†å² -->
        <div>
            <h4 style="color:#333;">ä½¿ç”¨å†å²</h4>
            <div id="card-usage-history" class="record-list">
                <!-- æ— ä½¿ç”¨è®°å½•æ—¶æ˜¾ç¤º -->
                <div id="no-usage-record" class="record-item" style="justify-content:center;color:#666;">æš‚æ— ä½¿ç”¨è®°å½•</div>
                <!-- ä½¿ç”¨è®°å½•å°†åŠ¨æ€æ·»åŠ  -->
            </div>
        </div>
    </div>
</section>

<script>
// åˆå§‹åŒ–ä¸€å¡é€šæ¿å—
document.addEventListener("DOMContentLoaded", function() {
    // è‡ªåŠ¨å¡«å……é€šè¯ç¼–å·
    const token = document.getElementById('userToken').textContent;
    if (token && token !== '--') {
        document.getElementById('card-token').value = token;
    }

    // æ£€æŸ¥æ˜¯å¦å·²åŠå¡
    const cardData = localStorage.getItem('daliang-universal-card');
    if (cardData) {
        renderCard(JSON.parse(cardData));
    }

    // åŠ è½½ä½¿ç”¨å†å²
    loadCardUsageHistory();
});

// æäº¤åŠå¡ç”³è¯·
function submitCardApplication() {
    const realname = document.getElementById('card-realname').value.trim();
    const token = document.getElementById('card-token').value.trim();
    const phone = document.getElementById('card-phone').value.trim();
    const address = document.getElementById('card-address').value.trim();
    const cardType = document.getElementById('card-type').value;

    if (!realname || !token || !phone || !address) {
        alert('è¯·å¡«å†™å®Œæ•´åŠå¡ä¿¡æ¯');
        return;
    }

    // ç”Ÿæˆå¡ç‰‡æ•°æ®
    const cardData = {
        realname: realname,
        token: token,
        phone: phone,
        address: address,
        cardType: cardType === 'standard' ? 'æ ‡å‡†å¡ï¼ˆå«äº¤é€š+ç¤¾ä¿+åŒ»ä¿åŠŸèƒ½ï¼‰' : 
                  cardType === 'senior' ? 'è€å¹´å¡ï¼ˆé¢å¤–äº«ä¼˜æƒ æ”¿ç­–ï¼‰' : 'å­¦ç”Ÿå¡ï¼ˆé¢å¤–äº«æ•™è‚²ç›¸å…³åŠŸèƒ½ï¼‰',
        applyDate: new Date().toLocaleDateString(),
        uniqueId: 'DC' + token.substr(-6) + Math.floor(Math.random() * 1000).toString().padStart(3, '0'),
        status: 'normal'
    };

    // å­˜å‚¨åˆ°localStorage
    localStorage.setItem('daliang-universal-card', JSON.stringify(cardData));
    renderCard(cardData);
    alert('åŠå¡æˆåŠŸï¼å¤§å‡‰å›½ä¼—ç”Ÿä¸€å¡é€šå·²ç”Ÿæ•ˆ');
}

// æ¸²æŸ“å·²åŠå¡ç‰‡
function renderCard(cardData) {
    document.getElementById('card-apply-form').style.display = 'none';
    document.getElementById('card-display').style.display = 'block';
    document.getElementById('card-info').style.display = 'block';

    // å¡«å……å¡ç‰‡ä¿¡æ¯
    document.getElementById('card-display-name').textContent = cardData.realname;
        document.getElementById('card-display-token').textContent = cardData.token;
    document.getElementById('card-display-type').textContent = cardData.cardType;
    document.getElementById('card-display-date').textContent = cardData.applyDate;
    document.getElementById('card-unique-id').textContent = cardData.uniqueId;
}

// è§£é™¤å¡ç‰‡
function cancelCard() {
    if (confirm('ç¡®å®šè¦è§£é™¤å¤§å‡‰å›½ä¼—ç”Ÿä¸€å¡é€šå—ï¼Ÿè§£é™¤åéœ€é‡æ–°åŠå¡')) {
        localStorage.removeItem('daliang-universal-card');
        localStorage.removeItem('daliang-card-usage-history');
        document.getElementById('card-display').style.display = 'none';
        document.getElementById('card-info').style.display = 'none';
        document.getElementById('card-apply-form').style.display = 'block';
        // é‡ç½®è¡¨å•
        document.getElementById('card-realname').value = '';
        document.getElementById('card-phone').value = '';
        document.getElementById('card-address').value = '';
        document.getElementById('card-type').value = 'standard';
        alert('å¡ç‰‡å·²è§£é™¤ï¼Œå¦‚éœ€ä½¿ç”¨è¯·é‡æ–°åŠå¡');
    }
}

// åŠ è½½ä½¿ç”¨å†å²
function loadCardUsageHistory() {
    const history = localStorage.getItem('daliang-card-usage-history');
    const historyContainer = document.getElementById('card-usage-history');
    
    if (history) {
        const historyList = JSON.parse(history);
        if (historyList.length > 0) {
            document.getElementById('no-usage-record').style.display = 'none';
            historyList.forEach(item => {
                const recordItem = document.createElement('div');
                recordItem.className = 'record-item';
                recordItem.innerHTML = `
                    <span>${item.scene} - ${item.action}</span>
                    <span>${item.time}</span>
                `;
                historyContainer.appendChild(recordItem);
            });
        }
    }
}

// æ¨¡æ‹Ÿæ·»åŠ ä½¿ç”¨è®°å½•ï¼ˆå¯åœ¨å…¶ä»–åŠŸèƒ½ä¸­è°ƒç”¨ï¼Œæ­¤å¤„ä»…ä¸ºç¤ºä¾‹å…¥å£ï¼‰
function addCardUsageRecord(scene, action) {
    const history = localStorage.getItem('daliang-card-usage-history') ? 
                   JSON.parse(localStorage.getItem('daliang-card-usage-history')) : [];
    history.unshift({
        scene: scene,
        action: action,
        time: new Date().toLocaleString()
    });
    // æœ€å¤šä¿ç•™20æ¡è®°å½•
    if (history.length > 20) history.pop();
    localStorage.setItem('daliang-card-usage-history', JSON.stringify(history));
    // åˆ·æ–°å†å²è®°å½•æ˜¾ç¤º
    document.getElementById('card-usage-history').innerHTML = '';
    loadCardUsageHistory();
}
</script>
    
    <section id="parliament" class="section">
    <h2>è®®æ¡ˆæŠ•ç¥¨</h2>
    <div id="proposal-list">
        <!-- åŠ¨æ€ç”Ÿæˆçš„è®®æ¡ˆä¼šæ’å…¥è¿™é‡Œ -->
    </div>
</section>

    <!-- å…¶ä»– -->
    <section id="other" class="section">
        <h2>å…¶ä»–</h2>
        <label>æ”¶è—å¤¹</label><textarea id="favorites" rows="4" placeholder="ç²˜è´´æ”¶è—é“¾æ¥æˆ–æ–‡å­—"></textarea>
        <label>ç¬”è®°</label><textarea id="notes" rows="6" placeholder="ä¸ªäººç¬”è®°"></textarea>
        <label>å¿«æ·çŸ­è¯­</label><input id="quickPhrase" placeholder="ä¸€é”®å‘é€çš„çŸ­è¯­">
        <button class="submit" onclick="saveOther()">ä¿å­˜å…¶ä»–</button>
    </section>

    <!-- å…¬æ°‘äº’åŠ¨ -->
    <section id="citizen" class="section">
        <h2>å…¬æ°‘äº’åŠ¨åŠŸèƒ½</h2>
        <button class="submit" onclick="openModal('modal-apply')">é€šè¯ç”³é¢†æ¨¡æ‹Ÿ</button>
        <button class="submit" onclick="openModal('modal-calc')">åŸŸå¤–å…‘æ¢è®¡ç®—å™¨</button>
        <button class="submit" onclick="openModal('modal-query')">æ˜Ÿé™…å¤‡æ¡ˆæŸ¥è¯¢</button>
        <button class="submit" onclick="openModal('modal-feedback')">æ„è§åé¦ˆ</button>
        <button class="submit" onclick="openModal('modal-law')">æ³•å¾‹æ–‡ä»¶å¯¼èˆª</button>
    </section>

    <!-- æ¢ç´¢è®°å½• -->
    <section class="section active">
        <h2>è¶…å®‡å®™æ¢ç´¢è®°å½•</h2>
        <div class="record-list">
            <div class="record-item"><span>æµè§ˆã€Œè¶…å®‡å®™èµ·æºã€æ ¸å¿ƒæ–‡æ¡£</span><span class="record-time">2024-05-10 14:23</span></div>
            <div class="record-item"><span>è§£é”ã€Œæ˜Ÿé™…ç–†åŸŸã€åŸºç¡€æ˜Ÿå›¾</span><span class="record-time">2024-05-08 09:45</span></div>
            <div class="record-item"><span>é¦–æ¬¡å®Œæˆèº«ä»½éªŒè¯ç™»å½•</span><span class="record-time">2024-05-01 16:10</span></div>
        </div>
    </section>
</main><!-- ===== æ¡Œé¢å¸¸é©»åŠŸèƒ½é›†åˆ ===== -->
<section class="section active" style="margin-top:var(--gap);">
    <h2>å¿«æ·åŠŸèƒ½åŒº</h2>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px;">
        <button class="submit" onclick="openModal('modal-register')">æ³¨å†Œ/ç»­æœŸé€šè¯</button>
        <button class="submit" onclick="openModal('modal-special')">ç”³è¯·è®¿é—®ç‰¹åŒº</button>
        <button class="submit" onclick="openModal('modal-history')">å†å²è®°å½•</button>
        <button class="submit" onclick="openModal('modal-support')">åœ¨çº¿å®¢æœ</button>
        <button class="submit" onclick="openModal('modal-changepwd')">ä¿®æ”¹å¯†ç </button>
        <button class="submit" onclick="openModal('modal-bind')">ç»‘å®šæ‰‹æœº/é‚®ç®±</button>
        <button class="submit" onclick="openModal('modal-loginhist')">ç™»å½•å†å²</button>
    </div>
</section>

</div>

<!-- ===== å¼¹å±‚é›†åˆ ===== -->
<div id="modal-apply" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">é€šè¯ç”³é¢†æ¨¡æ‹Ÿ</span><span class="en">Token Application</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('ç”³é¢†æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label class="zh">å§“å</label><input required><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-calc" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">åŸŸå¤–å…‘æ¢è®¡ç®—å™¨</span><span class="en">Exchange Calculator</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <label class="zh">è¾“å…¥çºªå¿µå¸æ•°é‡</label><input type="number" id="coin" placeholder="100"><button class="submit" onclick="alert('å¯å…‘æ¢ '+(document.getElementById('coin').value*1.2)+' å¤–å¸ï¼ˆæ¨¡æ‹Ÿï¼‰')">è®¡ç®—</button>
</div></div>

<div id="modal-query" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ˜Ÿé™…å¤‡æ¡ˆæŸ¥è¯¢</span><span class="en">Record Query</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <input placeholder="è¾“å…¥é€šè¯ç¼–å·"><button class="submit" onclick="alert('æŸ¥è¯¢ç»“æœï¼šæ— é™åˆ¶é€šè¡Œï¼ˆæ¨¡æ‹Ÿï¼‰')">æŸ¥è¯¢</button>
</div></div>

<div id="modal-feedback" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ„è§åé¦ˆ</span><span class="en">Feedback</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼');closeModal();return false;"><select required><option value="">é€‰æ‹©æœºæ„</option><option>è§‰æ€§ç›‘å¯Ÿé™¢</option><option>è¶…å®‡å®™æŠ€æœ¯é™¢</option><option>åœ£ä¸–ç ”ç©¶åšè§ˆé™¢</option></select><textarea rows="4" required placeholder="è¯·å¡«å†™æ„è§"></textarea><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-law" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ³•å¾‹æ–‡ä»¶å¯¼èˆª</span><span class="en">Law Navigation</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <ul><li><a href="#">ç¬¬ä¸€ç«  æ€»åˆ™</a></li><li><a href="#">ç¬¬äºŒç«  é«˜ç»´å…¬æ°‘æƒ</a></li><li><a href="#">ç¬¬ä¸‰ç«  æ˜Ÿé™…é€šè¡Œ</a></li></ul>
</div></div>

<div id="modal-register" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">æ³¨å†Œ/ç»­æœŸé€šè¯</span><span class="en">Register/Renew</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('æäº¤æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label class="zh">å§“å</label><input required><label class="zh">é€šè¯ç¼–ç </label><input required><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-special" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ç”³è¯·è®¿é—®ç‰¹åŒº</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('ç”³è¯·å·²æäº¤ï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>ç›®çš„åœ°åŒº</label><select><option>ç€›å‡°ç‰¹åŒº</option><option>å®‡è”ç‰¹åŒº</option></select><label>ç”³è¯·ç†ç”±</label><textarea rows="4" required></textarea><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-history" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">å†å²è®°å½•</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <table width="100%"><tr><th>æ—¥æœŸ</th><th>æ“ä½œ</th></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆä¸€æ—¥</td><td>æ³¨å†Œé€šè¯</td></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆäº”æ—¥</td><td>ç”³è¯·è®¿é—®ç€›å‡°ç‰¹åŒº</td></tr></table>
</div></div>

<div id="modal-support" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">åœ¨çº¿å®¢æœ</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('é—®é¢˜å·²æäº¤ï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>é—®é¢˜æè¿°</label><textarea rows="4" required></textarea><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-changepwd" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ä¿®æ”¹å¯†ç </span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('å¯†ç ä¿®æ”¹æˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>å½“å‰å¯†ç </label><input type="password" required><label>æ–°å¯†ç </label><input type="password" required><label>ç¡®è®¤æ–°å¯†ç </label><input type="password" required><button class="submit" type="submit">æäº¤</button></form>
</div></div>

<div id="modal-bind" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ç»‘å®šæ‰‹æœº/é‚®ç®±</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <form onsubmit="alert('ç»‘å®šæˆåŠŸï¼ˆæ¨¡æ‹Ÿï¼‰');closeModal();return false;"><label>æ‰‹æœºå·</label><input required><label>é‚®ç®±</label><input type="email" required><button class="submit" type="submit">ç»‘å®š</button></form>
</div></div>

<div id="modal-loginhist" class="modal"><div class="modal-content">
    <div class="modal-head"><span class="zh">ç™»å½•å†å²</span><span class="close-btn" onclick="closeModal()">&times;</span></div>
    <table width="100%"><tr><th>æ—¥æœŸ</th><th>ç™»å½•åœ°ç‚¹</th></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆäºŒæ—¥</td><td>äº¬å¸ˆå‡¡å¤š</td></tr><tr><td>æ­£åº”å…ƒå¹´å…«æœˆå››æ—¥</td><td>ç€›å‡°ç‰¹åŒº</td></tr></table>
</div></div>

<script>
/* ===== å·¥å…· ===== */
const $=s=>document.querySelector(s);
function getParam(){
    const p={};
    location.search.slice(1).split('&').forEach(kv=>{
        const [k,v]=kv.split('=');
        p[k]=v?decodeURIComponent(v):'';
    });
    return p;
}
/* ===== å®ˆé—¨ + èµ‹å€¼ ===== */
const params=getParam();
if(!params.token||!params.name){alert('è¯·å…ˆç™»å½•');location.href='login.html';}
else{
    $('#currentUser').textContent=params.name;
    $('#userName').textContent=params.name;
    $('#userToken').textContent=params.token;
}
/* ===== åŒè¯­ ===== */
function toggleLang(){
    const isZh=$('html').lang!=='en';
    document.querySelectorAll('.zh').forEach(e=>e.style.display=isZh?'none':'block');
    document.querySelectorAll('.en').forEach(e=>e.style.display=isZh?'block':'none');
    $('html').lang=isZh?'en':'zh';
}
/* ===== æ¿å— ===== */
function showSec(id){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    $('#'+id).classList.add('active');
}
/* ===== ç­¾åˆ° ===== */
const todayKey='checkIn_'+new Date().toISOString().slice(0,10);
function initCheck(){
    const done=localStorage.getItem(todayKey);
    const streak=localStorage.getItem('streakTotal')||'0';
    $('#streak').textContent=streak;
    if(done){$('#btn-check').disabled=true;$('#btn-check').textContent='å·²ç­¾åˆ°';$('#check-status').textContent='ä»Šæ—¥å·²ç­¾åˆ°';}
}
function doCheckIn(){
    localStorage.setItem(todayKey,'1');
    let total=parseInt(localStorage.getItem('streakTotal')||'0');
    localStorage.setItem('streakTotal',total+1);
    $('#streak').textContent=total+1;
    $('#btn-check').disabled=true;$('#btn-check').textContent='å·²ç­¾åˆ°';
    $('#check-status').textContent='ç­¾åˆ°æˆåŠŸï¼æ„¿æ‚¨ä»Šæ—¥æä¹åœ†æ»¡ã€‚';
}
initCheck();
/* ===== å¤´åƒ ===== */
$('#avatarUpload').addEventListener('change',e=>{
    const file=e.target.files[0];if(!file)return;
    const reader=new FileReader();
    reader.onload=ev=>{$('.avatar').style.backgroundImage=`url(${ev.target.result})`;localStorage.setItem('avatar',ev.target.result);}
    reader.readAsDataURL(file);
});
/* ===== ç¼–è¾‘ç”¨æˆ·å ===== */
function editUserName(){
    const name=prompt('æ–°ç”¨æˆ·å',params.name);
    if(name&&name.trim()){$('#userName').textContent=name;$('#currentUser').textContent=name;}
}
/* ===== ä¿å­˜ ===== */
function saveAccount(){
    localStorage.setItem('nickname',$('#nickname').value);
    localStorage.setItem('birthday',$('#birthday').value);
    localStorage.setItem('bio',$('#bio').value);
    alert('å·²ä¿å­˜ï¼ˆæœ¬åœ°ï¼‰');
}
function saveGeneral(){
    localStorage.setItem('lang',$('#lang').value);
    localStorage.setItem('theme',$('#theme').value);
    localStorage.setItem('notify',$('#notify').checked);
    alert('å·²ä¿å­˜ï¼ˆæœ¬åœ°ï¼‰');
}
function saveOther(){
    localStorage.setItem('favorites',$('#favorites').value);
    localStorage.setItem('notes',$('#notes').value);
    localStorage.setItem('quickPhrase',$('#quickPhrase').value);
    alert('å·²ä¿å­˜ï¼ˆæœ¬åœ°ï¼‰');
}
function exportData(){
    const data={
        account:{nickname:localStorage.getItem('nickname'),birthday:localStorage.getItem('birthday'),bio:localStorage.getItem('bio')},
        general:{lang:localStorage.getItem('lang'),theme:localStorage.getItem('theme'),notify:localStorage.getItem('notify')},
        other:{favorites:localStorage.getItem('favorites'),notes:localStorage.getItem('notes'),quickPhrase:localStorage.getItem('quickPhrase')}
    };
    const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');a.href=url;a.download='myData.json';a.click();URL.revokeObjectURL(url);
}
function downloadCertificate(){
    const cert={name:localStorage.getItem('nickname')||'ç”¨æˆ·',tokenId:'DLR-2025-0001',issuer:'ä¸­å¤®åˆ¶è¯å‘è¯æ€»ç½²',issueDate:'2025-01-01',expiryDate:'2034-01-01',permissions:'å‡¡å¤šã€ç€›å‡°ã€å—æè¾¹åŒºéƒ½æŠ¤ã€å¦‚æ„è·¯å…¨åŸŸé€šè¡Œ'};
    const blob=new Blob([JSON.stringify(cert,null,2)],{type:'application/pdf'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');a.href=url;a.download='certificate.json';a.click();URL.revokeObjectURL(url);
}
/* ===== å¼¹å±‚ ===== */
function openModal(id){$('#'+id).classList.add('show');}
function closeModal(){document.querySelectorAll('.modal').forEach(m=>m.classList.remove('show'));}
/* ===== æœåŠ¡å…¥å£ ===== */
function registerRenew(){openModal('modal-register');}
function applySpecialAccess(){openModal('modal-special');}
function viewHistory(){openModal('modal-history');}
function onlineSupport(){openModal('modal-support');}
function changePassword(){openModal('modal-changepwd');}
function bindPhoneEmail(){openModal('modal-bind');}
function viewLoginHistory(){openModal('modal-loginhist');}
</script>
<script>
function generateProposal(id) {
    const titles = [
        "å¤§å‡‰å›½åŸºç¡€è®¾æ–½å»ºè®¾",
        "è¶…å®‡å®™æ–‡æ˜ç§‘ç ”è®¡åˆ’",
        "å…¨æ°‘æ–‡åŒ–æ•™è‚²æå‡",
        "ç”Ÿæ€ä¿æŠ¤ä¸è‡ªç„¶æ³•ç»´æŠ¤",
        "å›½æ°‘å¹¸ç¦æŒ‡æ•°æå‡é¡¹ç›®",
        "å…¬å…±å®‰å…¨ä¸é˜²æŠ¤ç³»ç»Ÿä¼˜åŒ–"
    ];
    const descs = [
        "æå‡å…¨å›½å„åœ°åŸºç¡€è®¾æ–½å»ºè®¾æ°´å¹³",
        "èµ„åŠ©è¶…å®‡å®™æ–‡æ˜ç§‘ç ”é¡¹ç›®",
        "æ™®åŠæ–‡åŒ–æ•™è‚²ï¼Œæå‡æ–‡æ˜ç´ å…»",
        "åŠ å¼ºç”Ÿæ€ä¿æŠ¤ä¸è‡ªç„¶æ³•æ‰§è¡Œ",
        "æ”¹å–„æ°‘ç”Ÿï¼Œæé«˜å…¬æ°‘å¹¸ç¦æ„Ÿ",
        "å®Œå–„å…¬å…±å®‰å…¨ä¸é˜²æŠ¤ä½“ç³»"
    ];
    const t = titles[Math.floor(Math.random() * titles.length)];
    const d = descs[Math.floor(Math.random() * descs.length)];
    
    return { id, title: t, desc: d };
}

function renderProposals(count = 5) {
    const container = document.getElementById("proposal-list");
    container.innerHTML = "";
    for (let i = 1; i <= count; i++) {
        const p = generateProposal(i);
        const div = document.createElement("div");
        div.className = "proposal-item";
        div.style.borderBottom = "1px dashed #f2f3f5";
        div.style.padding = "10px 0";
        div.innerHTML = `
            <p><strong>è®®æ¡ˆæ ‡é¢˜ï¼š</strong>${p.title}</p>
            <p><strong>ç®€ä»‹ï¼š</strong>${p.desc}</p>
            <button onclick="voteProposal(${p.id}, 'yes')">æ”¯æŒ âœ…</button>
            <button onclick="voteProposal(${p.id}, 'no')">åå¯¹ âŒ</button>
        `;
        container.appendChild(div);
    }
}

function voteProposal(id, choice) {
    alert(`ä½ å¯¹è®®æ¡ˆ ${id} çš„æŠ•ç¥¨ï¼š${choice}`);
}

// é¡µé¢åŠ è½½æ—¶ç”Ÿæˆè®®æ¡ˆ
document.addEventListener("DOMContentLoaded", function () {
    renderProposals(5);
});

</script>
</body>
</html>
